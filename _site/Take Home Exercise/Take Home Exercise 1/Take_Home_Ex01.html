<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Take-home Exercise 1: Geospatial Analytics for Public Good – ISSS626</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-a14e3238c51140e99ccc48519b6ed9ce.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS626</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../.././Hands-on_Ex/Hands-on_Ex01/Hands_On_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../.././Hands-on_Ex/Hands-on_Ex02/Hands_On_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../.././Hands-on_Ex/Hands-on_Ex03/Hands_On_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../.././Hands-on_Ex/Hands-on_Ex04/Hands_On_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../.././Hands-on_Ex/Hands-on_Ex05/Hands_On_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise5</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../.././In-Class Exercise/In-Class Exercise 3/In_Class_Ex03a.html">
 <span class="dropdown-text">In-class Exercise 3a</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../.././Take Home Exercise/Take Home Exercise 1/Take_Home_Ex01.html">
 <span class="dropdown-text">Take-Home Exercise1</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link active" data-scroll-target="#setting-the-scene">Setting the scene</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#submission" id="toc-submission" class="nav-link" data-scroll-target="#submission">Submission</a>
  <ul class="collapse">
  <li><a href="#reading-data" id="toc-reading-data" class="nav-link" data-scroll-target="#reading-data">Reading data</a></li>
  <li><a href="#restaurant-business" id="toc-restaurant-business" class="nav-link" data-scroll-target="#restaurant-business">1. Restaurant Business</a>
  <ul class="collapse">
  <li><a href="#tidying-data" id="toc-tidying-data" class="nav-link" data-scroll-target="#tidying-data">Tidying Data</a></li>
  <li><a href="#geocoding" id="toc-geocoding" class="nav-link" data-scroll-target="#geocoding">Geocoding</a></li>
  <li><a href="#understanding-data" id="toc-understanding-data" class="nav-link" data-scroll-target="#understanding-data">Understanding Data</a></li>
  <li><a href="#convert-sf-dataframe-to-ppp-class" id="toc-convert-sf-dataframe-to-ppp-class" class="nav-link" data-scroll-target="#convert-sf-dataframe-to-ppp-class">Convert sf dataframe to ppp class</a></li>
  <li><a href="#create-owin-object" id="toc-create-owin-object" class="nav-link" data-scroll-target="#create-owin-object">Create owin object</a></li>
  <li><a href="#combine-point-events-object-and-owin-object" id="toc-combine-point-events-object-and-owin-object" class="nav-link" data-scroll-target="#combine-point-events-object-and-owin-object">Combine point events object and owin object</a></li>
  <li><a href="#clark-evan-test-for-nearest-neighbour-analysis" id="toc-clark-evan-test-for-nearest-neighbour-analysis" class="nav-link" data-scroll-target="#clark-evan-test-for-nearest-neighbour-analysis">Clark-Evan Test for Nearest Neighbour Analysis</a></li>
  <li><a href="#kernel-density-estimation" id="toc-kernel-density-estimation" class="nav-link" data-scroll-target="#kernel-density-estimation">Kernel Density Estimation</a></li>
  <li><a href="#nd-order-spatial-point-pattern-analysis" id="toc-nd-order-spatial-point-pattern-analysis" class="nav-link" data-scroll-target="#nd-order-spatial-point-pattern-analysis">2nd Order Spatial Point Pattern Analysis</a></li>
  <li><a href="#spatio-temporal-point-patterns-analysis" id="toc-spatio-temporal-point-patterns-analysis" class="nav-link" data-scroll-target="#spatio-temporal-point-patterns-analysis">Spatio-Temporal Point Patterns Analysis</a></li>
  </ul></li>
  <li><a href="#it-consultancy-business" id="toc-it-consultancy-business" class="nav-link" data-scroll-target="#it-consultancy-business">2. IT Consultancy Business</a>
  <ul class="collapse">
  <li><a href="#tidying-data-1" id="toc-tidying-data-1" class="nav-link" data-scroll-target="#tidying-data-1">Tidying Data</a></li>
  <li><a href="#geocoding-1" id="toc-geocoding-1" class="nav-link" data-scroll-target="#geocoding-1">Geocoding</a></li>
  <li><a href="#understanding-data-1" id="toc-understanding-data-1" class="nav-link" data-scroll-target="#understanding-data-1">Understanding Data</a></li>
  <li><a href="#convert-sf-dataframe-to-ppp-class-1" id="toc-convert-sf-dataframe-to-ppp-class-1" class="nav-link" data-scroll-target="#convert-sf-dataframe-to-ppp-class-1">Convert sf dataframe to ppp class</a></li>
  <li><a href="#create-owin-object-1" id="toc-create-owin-object-1" class="nav-link" data-scroll-target="#create-owin-object-1">Create owin object</a></li>
  <li><a href="#combine-point-events-object-and-owin-object-1" id="toc-combine-point-events-object-and-owin-object-1" class="nav-link" data-scroll-target="#combine-point-events-object-and-owin-object-1">Combine point events object and owin object</a></li>
  <li><a href="#clark-evan-test-for-nearest-neighbour-analysis-1" id="toc-clark-evan-test-for-nearest-neighbour-analysis-1" class="nav-link" data-scroll-target="#clark-evan-test-for-nearest-neighbour-analysis-1">Clark-Evan Test for Nearest Neighbour Analysis</a></li>
  <li><a href="#kernel-density-estimation-1" id="toc-kernel-density-estimation-1" class="nav-link" data-scroll-target="#kernel-density-estimation-1">Kernel Density Estimation</a></li>
  <li><a href="#nd-order-spatial-point-pattern-analysis-1" id="toc-nd-order-spatial-point-pattern-analysis-1" class="nav-link" data-scroll-target="#nd-order-spatial-point-pattern-analysis-1">2nd Order Spatial Point Pattern Analysis</a></li>
  <li><a href="#spatio-temporal-point-patterns-analysis-1" id="toc-spatio-temporal-point-patterns-analysis-1" class="nav-link" data-scroll-target="#spatio-temporal-point-patterns-analysis-1">Spatio-Temporal Point Patterns Analysis</a></li>
  </ul></li>
  <li><a href="#clothing-retail-business" id="toc-clothing-retail-business" class="nav-link" data-scroll-target="#clothing-retail-business">3. Clothing Retail Business</a>
  <ul class="collapse">
  <li><a href="#tidying-data-2" id="toc-tidying-data-2" class="nav-link" data-scroll-target="#tidying-data-2">Tidying Data</a></li>
  <li><a href="#geocoding-2" id="toc-geocoding-2" class="nav-link" data-scroll-target="#geocoding-2">Geocoding</a></li>
  <li><a href="#understanding-data-2" id="toc-understanding-data-2" class="nav-link" data-scroll-target="#understanding-data-2">Understanding Data</a></li>
  <li><a href="#convert-sf-dataframe-to-ppp-class-2" id="toc-convert-sf-dataframe-to-ppp-class-2" class="nav-link" data-scroll-target="#convert-sf-dataframe-to-ppp-class-2">Convert sf dataframe to ppp class</a></li>
  <li><a href="#create-owin-object-2" id="toc-create-owin-object-2" class="nav-link" data-scroll-target="#create-owin-object-2">Create owin object</a></li>
  <li><a href="#combine-point-events-object-and-owin-object-2" id="toc-combine-point-events-object-and-owin-object-2" class="nav-link" data-scroll-target="#combine-point-events-object-and-owin-object-2">Combine point events object and owin object</a></li>
  <li><a href="#clark-evan-test-for-nearest-neighbour-analysis-2" id="toc-clark-evan-test-for-nearest-neighbour-analysis-2" class="nav-link" data-scroll-target="#clark-evan-test-for-nearest-neighbour-analysis-2">Clark-Evan Test for Nearest Neighbour Analysis</a></li>
  <li><a href="#kernel-density-estimation-2" id="toc-kernel-density-estimation-2" class="nav-link" data-scroll-target="#kernel-density-estimation-2">Kernel Density Estimation</a></li>
  <li><a href="#nd-order-spatial-point-pattern-analysis-2" id="toc-nd-order-spatial-point-pattern-analysis-2" class="nav-link" data-scroll-target="#nd-order-spatial-point-pattern-analysis-2">2nd Order Spatial Point Pattern Analysis</a></li>
  <li><a href="#spatio-temporal-point-patterns-analysis-2" id="toc-spatio-temporal-point-patterns-analysis-2" class="nav-link" data-scroll-target="#spatio-temporal-point-patterns-analysis-2">Spatio-Temporal Point Patterns Analysis</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 1: Geospatial Analytics for Public Good</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="setting-the-scene" class="level1">
<h1>Setting the scene</h1>
<p>The locations of businesses and firms are central to urban development, influencing economic growth, job creation, and the availability of resources and services for residents and other businesses. Strategic locations provide competitive advantages, access to talent and infrastructure, and impact brand image and market positioning, while also shaping the city’s overall character and functionality by fostering specialized districts and facilitating efficient supply chains and employee commutes.</p>
<p>Studying the spatio-temporal patterns of businesses and firms is crucial for urban development because it reveals how economic activity and urban forms evolve, enabling better urban planning, promoting sustainability, identifying urban inefficiencies, and enhancing quality of life. By understanding where and when businesses locate and operate, urban planners can design cities more effectively, anticipate growth, ensure resource efficiency, and tailor infrastructure to support economic vitality and community well-being.</p>
</section>
<section id="objectives" class="level1">
<h1>Objectives</h1>
<p>In this take-home exercise, we are interested to investigate the spatial and spatio-temporal patterns of new businesses and firms established in Singapore for the first six months of 2025</p>
<p>The specific objectives of this take-home exercise are as follows:</p>
<ul>
<li><p>To identify the “where” and “when” of new business entities, revealing clusters, patterns, and trends that are crucial for informed urban planning, resource allocation, and economic development.</p></li>
<li><p>To identify complex interaction patterns and emergent phenomena in the distribution of new businesses beyond simple proximity or density, such as clustering of related businesses, the influence of past trends on future locations, and the overall structural development of commercial areas, which are crucial for scientific urban planning and policy-making.</p></li>
</ul>
<p>By understanding where businesses are located and how their distribution changes over time, urban planners nad managers can unlock spatial intelligence, optimize operations, and create effective strategies to attract investment and promote sustainable growth.</p>
</section>
<section id="submission" class="level1">
<h1>Submission</h1>
<section id="reading-data" class="level2">
<h2 class="anchored" data-anchor-id="reading-data">Reading data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tcltk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, sf, tmap, httr, terra, spatstat, rvest, tidyverse, stpp, sparr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"/Users/zishengwong/R Coding/ISSS626 Geospatial Analytics/Take Home Exercise/Take Home Exercise 1"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>folder_path <span class="ot">&lt;-</span> <span class="st">"./data/aspatial/acra"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>file_list <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> folder_path,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pattern =</span> <span class="st">"^ACRA*.*</span><span class="sc">\\</span><span class="st">.csv$"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>acra_data <span class="ot">&lt;-</span> file_list <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dfr</span>(read_csv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 166348 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 90920 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 135478 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 70351 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 83190 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 66990 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 81783 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 90798 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 58738 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 65251 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 73983 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 89064 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 118925 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 57432 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 39336 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 21124 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 95595 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 11790 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 67792 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 224176 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 136758 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 23592 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 35777 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 55774 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 12396 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 36391 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.
Rows: 17183 Columns: 53
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (49): uen, issuance_agency_id, entity_name, entity_type_description, bu...
dbl   (2): primary_ssic_code, no_of_officers
date  (2): registration_incorporation_date, uen_issue_date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(acra_data,</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#          "data/rds/acra_data.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>acra_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"./data/rds/acra_data.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of records by SSIC code</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ssic_counts <span class="ot">&lt;-</span> acra_data <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(primary_ssic_code, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View top 20 SSIC codes with most records</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ssic_counts, <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 2
   primary_ssic_code      n
               &lt;dbl&gt;  &lt;int&gt;
 1             46900 210383
 2             70201 103016
 3             64202  97902
 4             62011  42870
 5             47711  37488
 6             41009  32778
 7             43301  31730
 8             62021  29380
 9             49215  27381
10             56111  26242
11             85409  26107
12             41001  25417
13             96099  24693
14             70209  19453
15             56140  19389
16             74191  19078
17             56122  19022
18             96022  18384
19             46100  18095
20             73100  17011</code></pre>
</div>
</div>
</section>
<section id="restaurant-business" class="level2">
<h2 class="anchored" data-anchor-id="restaurant-business">1. Restaurant Business</h2>
<section id="tidying-data" class="level3">
<h3 class="anchored" data-anchor-id="tidying-data">Tidying Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>rest_biz_56111 <span class="ot">&lt;-</span> acra_data <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(primary_ssic_code <span class="sc">==</span> <span class="dv">56111</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date =</span> registration_incorporation_date) <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date),</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">YEAR =</span> <span class="fu">year</span>(date),</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">MONTH_NUM =</span> <span class="fu">month</span>(date),</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">MONTH_ABBR =</span> <span class="fu">month</span>(date,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">abbr =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">postal_code =</span> <span class="fu">str_pad</span>(postal_code,</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">width =</span> <span class="dv">6</span>, <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">pad =</span> <span class="st">"0"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(YEAR <span class="sc">==</span> <span class="dv">2025</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="geocoding" class="level3">
<h3 class="anchored" data-anchor-id="geocoding">Geocoding</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>postcodes <span class="ot">&lt;-</span> <span class="fu">unique</span>(rest_biz_56111<span class="sc">$</span>postal_code)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>found <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>not_found <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">postcode =</span> <span class="fu">character</span>())</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://onemap.gov.sg/api/common/elastic/search"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pc <span class="cf">in</span> postcodes) {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchVal =</span> pc,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">returnGeom =</span> <span class="st">"Y"</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">getAddrDetails =</span> <span class="st">"Y"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageNum =</span> <span class="st">"1"</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(url, <span class="at">query =</span> query)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  json <span class="ot">&lt;-</span> <span class="fu">content</span>(res)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (json<span class="sc">$</span>found <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(json<span class="sc">$</span>results, <span class="at">stringAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>input_postcode <span class="ot">&lt;-</span> pc</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    found <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(found, df)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    not_found <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(not_found, <span class="fu">data.frame</span>(<span class="at">postcode =</span> pc))</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>rest_biz_56111 <span class="ot">=</span> rest_biz_56111 <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(found,</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'postal_code'</span> <span class="ot">=</span> <span class="st">'POSTAL'</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">relationship =</span> <span class="st">"many-to-many"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>rest_biz_56111_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(rest_biz_56111,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"X"</span>,<span class="st">"Y"</span>),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Save rest_biz_56111_sf file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(rest_biz_56111_sf, "data/rds/rest_biz_56111_sf.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="understanding-data" class="level3">
<h3 class="anchored" data-anchor-id="understanding-data">Understanding Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>rest_biz_56111_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/rest_biz_56111_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(rest_biz_56111_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 125 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 27549.59 ymin: 31216.93 xmax: 37390.83 ymax: 46589.95
Projected CRS: SVY21 / Singapore TM
# A tibble: 6 × 126
  uen        issuance_agency_id entity_name               entity_type_descript…¹
  &lt;chr&gt;      &lt;chr&gt;              &lt;chr&gt;                     &lt;chr&gt;                 
1 202501136C ACRA               AL ASHIK PTE. LTD.        Local Company         
2 202501329K ACRA               ARASH LEGACY PTE. LTD.    Local Company         
3 202502902M ACRA               ADAM'S FAMILY CATERING P… Local Company         
4 202503682G ACRA               ASWINS VEG RESTAURANT PT… Local Company         
5 202504143K ACRA               ADIRAI KR BRIYANI PTE. L… Local Company         
6 202504371R ACRA               AL YASSIN CAFE  (S) PTE.… Local Company         
# ℹ abbreviated name: ¹​entity_type_description
# ℹ 122 more variables: business_constitution_description &lt;chr&gt;,
#   company_type_description &lt;chr&gt;, paf_constitution_description &lt;chr&gt;,
#   entity_status_description &lt;chr&gt;, date &lt;date&gt;, uen_issue_date &lt;date&gt;,
#   address_type &lt;chr&gt;, block &lt;chr&gt;, street_name &lt;chr&gt;, level_no &lt;chr&gt;,
#   unit_no &lt;chr&gt;, building_name &lt;chr&gt;, postal_code &lt;chr&gt;,
#   other_address_line1 &lt;chr&gt;, other_address_line2 &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Number of businesses</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of businesses</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(rest_biz_56111_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 677</code></pre>
</div>
</div>
<p>Plotting data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rest_biz_56111_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: plotting the first 9 out of 125 attributes; use max.plot = 125 to plot
all</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="convert-sf-dataframe-to-ppp-class" class="level3">
<h3 class="anchored" data-anchor-id="convert-sf-dataframe-to-ppp-class">Convert sf dataframe to ppp class</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>rest_biz_56111_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(rest_biz_56111_sf)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(rest_biz_56111_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ppp"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#summary(rest_biz_56111_ppp)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="create-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="create-owin-object">Create owin object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mpsz_cl <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mpsz_cl.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>sg_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(mpsz_cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sg_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combine-point-events-object-and-owin-object" class="level3">
<h3 class="anchored" data-anchor-id="combine-point-events-object-and-owin-object">Combine point events object and owin object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>rest_biz_56111_ppp <span class="ot">=</span> rest_biz_56111_ppp[sg_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>rest_biz_56111_ppp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern x</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern: 677 points
Mark variables: 
   uen issuance_agency_id entity_name entity_type_description 
business_constitution_description company_type_description 
paf_constitution_description entity_status_description date uen_issue_date 
address_type block street_name level_no unit_no building_name postal_code 
other_address_line1 other_address_line2 account_due_date annual_return_date 
primary_ssic_code primary_ssic_description primary_user_described_activity YEAR 
MONTH_NUM MONTH_ABBR SEARCHVAL BLK_NO ROAD_NAME BUILDING ADDRESS LATITUDE 
LONGITUDE input_postcode SEARCHVAL.1 BLK_NO.1 ROAD_NAME.1 BUILDING.1 ADDRESS.1 
POSTAL.1 X.1 Y.1 LATITUDE.1 LONGITUDE.1 SEARCHVAL.2 BLK_NO.2 ROAD_NAME.2 
BUILDING.2 ADDRESS.2 POSTAL.2 X.2 Y.2 LATITUDE.2 LONGITUDE.2 SEARCHVAL.3 
BLK_NO.3 ROAD_NAME.3 BUILDING.3 ADDRESS.3 POSTAL.3 X.3 Y.3 LATITUDE.3 
LONGITUDE.3 SEARCHVAL.4 BLK_NO.4 ROAD_NAME.4 BUILDING.4 ADDRESS.4 POSTAL.4 X.4 
Y.4 LATITUDE.4 LONGITUDE.4 SEARCHVAL.5 BLK_NO.5 ROAD_NAME.5 BUILDING.5 
ADDRESS.5 POSTAL.5 X.5 Y.5 LATITUDE.5 LONGITUDE.5 SEARCHVAL.6 BLK_NO.6 
ROAD_NAME.6 BUILDING.6 ADDRESS.6 POSTAL.6 X.6 Y.6 LATITUDE.6 LONGITUDE.6 
SEARCHVAL.7 BLK_NO.7 ROAD_NAME.7 BUILDING.7 ADDRESS.7 POSTAL.7 X.7 Y.7 
LATITUDE.7 LONGITUDE.7 SEARCHVAL.8 BLK_NO.8 ROAD_NAME.8 BUILDING.8 ADDRESS.8 
POSTAL.8 X.8 Y.8 LATITUDE.8 LONGITUDE.8 SEARCHVAL.9 BLK_NO.9 ROAD_NAME.9 
BUILDING.9 ADDRESS.9 POSTAL.9 X.9 Y.9 LATITUDE.9 LONGITUDE.9
window: polygonal boundary
enclosing rectangle: [2667.54, 55941.94] x [21448.47, 50256.33] units</code></pre>
</div>
</div>
</section>
<section id="clark-evan-test-for-nearest-neighbour-analysis" class="level3">
<h3 class="anchored" data-anchor-id="clark-evan-test-for-nearest-neighbour-analysis">Clark-Evan Test for Nearest Neighbour Analysis</h3>
<p>Without CSR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(rest_biz_56111_ppp,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clark-Evans test
    No edge correction
    Z-test

data:  rest_biz_56111_ppp
R = 0.46636, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
<p>With CSR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(rest_biz_56111_ppp,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">method=</span><span class="st">"MonteCarlo"</span>,</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clark-Evans test
    No edge correction
    Monte Carlo test based on 99 simulations of CSR with fixed n

data:  rest_biz_56111_ppp
R = 0.46636, p-value = 0.01
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
<p>Taking a 95% confidence level, the Clark-Evans test showed that p-value were consistently below the threshold &lt; 0.05, indicating that restaurants are not randomly distributed.</p>
</section>
<section id="kernel-density-estimation" class="level3">
<h3 class="anchored" data-anchor-id="kernel-density-estimation">Kernel Density Estimation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>rest_biz_56111_ppp_km <span class="ot">&lt;-</span> <span class="fu">rescale.ppp</span>(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  rest_biz_56111_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>rest_kde_SG_diggle <span class="ot">&lt;-</span> <span class="fu">density</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  rest_biz_56111_ppp_km,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel=</span><span class="st">"gaussian"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rest_kde_SG_diggle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rest_kde_SG_diggle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>real-valued pixel image
128 x 128 pixel array (ny, nx)
enclosing rectangle: [2.667538, 55.94194] x [21.44847, 50.25633] km
dimensions of each pixel: 0.416 x 0.2250614 km
Image is defined on a subset of the rectangular grid
Subset area = 669.941961122495 square km
Subset area fraction = 0.437
Pixel values (inside window):
    range = [-2.821452e-14, 160.1333]
    integral = 677
    mean = 1.010535</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">bw.diggle</span>(rest_biz_56111_ppp_km)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>bw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      sigma 
0.007046933 </code></pre>
</div>
</div>
<p>This kernel density estimation (KDE) map displays the spatial intensity of restaurant (SSIC 56111) registrations in Singapore between January 2024 and June 2025. Using a Gaussian kernel with bandwidth selected via Diggle’s method (σ = 0.007 km), the analysis smooths the point distribution to highlight areas of higher concentration. The resulting density surface reveals clear hotspots in the central and downtown planning areas, particularly the CBD and surrounding commercial districts, where density values exceed 250 establishments per km². Peripheral residential and industrial zones exhibit much lower intensities, reflecting limited restaurant formation in those areas. The KDE thus suggests a strong central clustering of new restaurants, consistent with agglomeration economies and accessibility to consumer demand. As KDE is a smoothing technique, the visualization emphasizes general spatial patterns over exact point counts, making it well-suited for urban land-use and retail planning.</p>
</section>
<section id="nd-order-spatial-point-pattern-analysis" class="level3">
<h3 class="anchored" data-anchor-id="nd-order-spatial-point-pattern-analysis">2nd Order Spatial Point Pattern Analysis</h3>
<section id="using-k-function" class="level4">
<h4 class="anchored" data-anchor-id="using-k-function">Using K-Function</h4>
<p>Computing K-Function estimate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>K_rest <span class="ot">=</span> <span class="fu">Kest</span>(rest_biz_56111_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_rest, . <span class="sc">-</span>r <span class="sc">~</span> r, <span class="at">ylab=</span> <span class="st">"K(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Performing Complete Spatial Randomness Test</strong></p>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<p>Ho = The distribution of restaurants in Singapore are randomly distributed.</p>
<p>H1= The distribution of restaurants in Singapore are not randomly distributed.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>K_rest.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(rest_biz_56111_ppp, Kest, <span class="at">nsim =</span> <span class="dv">99</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">glocal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern Y</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern object</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 
[36:28 remaining, estimate finish 2025-09-23 22:42:26]
3, 
[32:47 remaining, estimate finish 2025-09-23 22:39:03]
4, 
[34:39 remaining, estimate finish 2025-09-23 22:41:20]
5, 
[35:13 remaining, estimate finish 2025-09-23 22:42:19]
6, 
[35:19 remaining, estimate finish 2025-09-23 22:42:48]
7, 
[35:54 remaining, estimate finish 2025-09-23 22:43:49]
8, 
[35:28 remaining, estimate finish 2025-09-23 22:43:47]
9, 
[35:19 remaining, estimate finish 2025-09-23 22:44:02]
10, 
[35:25 remaining, estimate finish 2025-09-23 22:44:35]
11, 
[35:36 remaining, estimate finish 2025-09-23 22:45:14]
12, 
[35:01 remaining, estimate finish 2025-09-23 22:45:02]
13, 
[35:05 remaining, estimate finish 2025-09-23 22:45:34]
14, 
[34:45 remaining, estimate finish 2025-09-23 22:45:40]
15, 
[34:12 remaining, estimate finish 2025-09-23 22:45:29]
16, 
[33:43 remaining, estimate finish 2025-09-23 22:45:23]
17, 
[32:57 remaining, estimate finish 2025-09-23 22:44:58]
18, 
[32:25 remaining, estimate finish 2025-09-23 22:44:48]
19, 
[32:03 remaining, estimate finish 2025-09-23 22:44:51]
20, 
[31:35 remaining, estimate finish 2025-09-23 22:44:46]
21, 
[31:01 remaining, estimate finish 2025-09-23 22:44:33]
22, 
[30:33 remaining, estimate finish 2025-09-23 22:44:28]
23, 
[30:09 remaining, estimate finish 2025-09-23 22:44:28]
24, 
[29:43 remaining, estimate finish 2025-09-23 22:44:26]
25, 
[29:10 remaining, estimate finish 2025-09-23 22:44:12]
26, 
[28:40 remaining, estimate finish 2025-09-23 22:44:05]
27, 
[28:15 remaining, estimate finish 2025-09-23 22:44:03]
28, 
[27:43 remaining, estimate finish 2025-09-23 22:43:51]
29, 
[27:28 remaining, estimate finish 2025-09-23 22:44:03]
30, 
[27:23 remaining, estimate finish 2025-09-23 22:44:29]
31, 
[26:57 remaining, estimate finish 2025-09-23 22:44:26]
32, 
[26:34 remaining, estimate finish 2025-09-23 22:44:27]
33, 
[26:06 remaining, estimate finish 2025-09-23 22:44:21]
34, 
[25:47 remaining, estimate finish 2025-09-23 22:44:28]
35, 
[25:23 remaining, estimate finish 2025-09-23 22:44:27]
36, 
[24:54 remaining, estimate finish 2025-09-23 22:44:19]
37, 
[24:28 remaining, estimate finish 2025-09-23 22:44:16]
38, 
[24:02 remaining, estimate finish 2025-09-23 22:44:12]
39, 
[23:36 remaining, estimate finish 2025-09-23 22:44:08]
40, 
[23:07 remaining, estimate finish 2025-09-23 22:43:59]
41, 
[22:47 remaining, estimate finish 2025-09-23 22:44:06]
42, 
[22:23 remaining, estimate finish 2025-09-23 22:44:04]
43, 
[22:01 remaining, estimate finish 2025-09-23 22:44:07]
44, 
[21:39 remaining, estimate finish 2025-09-23 22:44:10]
45, 
[21:12 remaining, estimate finish 2025-09-23 22:44:04]
46, 
[20:51 remaining, estimate finish 2025-09-23 22:44:08]
47, 
[20:31 remaining, estimate finish 2025-09-23 22:44:14]
48, 
[20:07 remaining, estimate finish 2025-09-23 22:44:14]
49, 
[19:44 remaining, estimate finish 2025-09-23 22:44:17]
50, 
[19:21 remaining, estimate finish 2025-09-23 22:44:17]
51, 
[18:58 remaining, estimate finish 2025-09-23 22:44:19]
52, 
[18:32 remaining, estimate finish 2025-09-23 22:44:15]
53, 
[18:12 remaining, estimate finish 2025-09-23 22:44:21]
54, 
[17:47 remaining, estimate finish 2025-09-23 22:44:19]
55, 
[17:22 remaining, estimate finish 2025-09-23 22:44:15]
56, 
[16:58 remaining, estimate finish 2025-09-23 22:44:16]
57, 
[16:35 remaining, estimate finish 2025-09-23 22:44:16]
58, 
[16:13 remaining, estimate finish 2025-09-23 22:44:20]
59, 
[15:50 remaining, estimate finish 2025-09-23 22:44:22]
60, 
[15:26 remaining, estimate finish 2025-09-23 22:44:23]
61, 
[15:05 remaining, estimate finish 2025-09-23 22:44:29]
62, 
[14:41 remaining, estimate finish 2025-09-23 22:44:28]
63, 
[14:16 remaining, estimate finish 2025-09-23 22:44:27]
64, 
[13:53 remaining, estimate finish 2025-09-23 22:44:27]
65, 
[13:28 remaining, estimate finish 2025-09-23 22:44:24]
66, 
[13:04 remaining, estimate finish 2025-09-23 22:44:25]
67, 
[12:42 remaining, estimate finish 2025-09-23 22:44:28]
68, 
[12:17 remaining, estimate finish 2025-09-23 22:44:24]
69, 
[11:54 remaining, estimate finish 2025-09-23 22:44:27]
70, 
[11:29 remaining, estimate finish 2025-09-23 22:44:25]
71, 
[11:05 remaining, estimate finish 2025-09-23 22:44:23]
72, 
[10:42 remaining, estimate finish 2025-09-23 22:44:26]
73, 
[10:19 remaining, estimate finish 2025-09-23 22:44:27]
74,  [9:55 remaining] 75,  [9:31 remaining] 76,  [9:07 remaining] 77,  [8:43 remaining] 78,  [8:19 remaining] 79,  [7:55 remaining] 80,  [7:31 remaining] 81,  [7:07 remaining] 82,  [6:44 remaining] 83,  [6:20 remaining] 84,  [5:56 remaining] 85,  [5:32 remaining] 86,  [5:09 remaining] 87,  [4:45 remaining] 88,  [4:22 remaining] 89,  [3:58 remaining] 90,  [3:35 remaining] 91,  [3:11 remaining] 92,  [2:47 remaining] 93,
 [2:23 remaining] 94,  [1:59 remaining] 95,  [1:36 remaining] 96,  [1:12 remaining] 97,  [48 sec remaining] 98,  [24 sec remaining] 
99.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_rest.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"K(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ripley’s K-function was applied with edge correction and plotted in the centered form (K(d) – CSR). The results reveal that at short distances (&lt;500m), the observed function lies above the CSR expectation, indicating significant clustering of restaurants. At larger distances, the function gradually approaches CSR, suggesting that clustering effects are primarily localised. When compared against CSR simulation envelopes, the observed curve exceeded the upper bounds at short ranges, confirming that clustering is statistically significant and not due to chance. This pattern aligns with the tendency for restaurants to co-locate in food districts, malls, and transport hubs.The second-order analysis reinforces the KDE findings, showing that spatial clustering of restaurants occurs mainly at neighbourhood or precinct level scales rather than city-wide.</p>
</section>
<section id="using-l-function" class="level4">
<h4 class="anchored" data-anchor-id="using-l-function">Using L-Function</h4>
<p>Computing L Function estimate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>L_rest <span class="ot">=</span> <span class="fu">Lest</span>(rest_biz_56111_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_rest, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Performing Complete Spatial Randomness Test</strong></p>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<p>Ho = The distribution of restaurants in Singapore are randomly distributed.</p>
<p>H1= The distribution of restaurants in Singapore are not randomly distributed.</p>
<p>The null hypothesis will be rejected if p-value if smaller than alpha value of 0.001.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>L_rest.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(rest_biz_56111_ppp, Lest, <span class="at">nsim =</span> <span class="dv">99</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">glocal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern Y</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern object</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 
[34:18 remaining, estimate finish 2025-09-23 23:21:24]
3, 
[35:33 remaining, estimate finish 2025-09-23 23:23:02]
4, 
[35:07 remaining, estimate finish 2025-09-23 23:22:58]
5, 
[35:48 remaining, estimate finish 2025-09-23 23:24:04]
6, 
[35:23 remaining, estimate finish 2025-09-23 23:24:02]
7, 
[34:49 remaining, estimate finish 2025-09-23 23:23:50]
8, 
[34:57 remaining, estimate finish 2025-09-23 23:24:23]
9, 
[34:54 remaining, estimate finish 2025-09-23 23:24:45]
10, 
[35:24 remaining, estimate finish 2025-09-23 23:25:44]
11, 
[35:02 remaining, estimate finish 2025-09-23 23:25:46]
12, 
[34:45 remaining, estimate finish 2025-09-23 23:25:53]
13, 
[34:20 remaining, estimate finish 2025-09-23 23:25:52]
14, 
[33:50 remaining, estimate finish 2025-09-23 23:25:45]
15, 
[33:34 remaining, estimate finish 2025-09-23 23:25:55]
16, 
[33:08 remaining, estimate finish 2025-09-23 23:25:53]
17, 
[32:41 remaining, estimate finish 2025-09-23 23:25:48]
18, 
[32:20 remaining, estimate finish 2025-09-23 23:25:52]
19, 
[31:56 remaining, estimate finish 2025-09-23 23:25:52]
20, 
[31:36 remaining, estimate finish 2025-09-23 23:25:57]
21, 
[31:23 remaining, estimate finish 2025-09-23 23:26:10]
22, 
[31:08 remaining, estimate finish 2025-09-23 23:26:23]
23, 
[30:40 remaining, estimate finish 2025-09-23 23:26:17]
24, 
[30:12 remaining, estimate finish 2025-09-23 23:26:12]
25, 
[29:49 remaining, estimate finish 2025-09-23 23:26:14]
26, 
[29:30 remaining, estimate finish 2025-09-23 23:26:21]
27, 
[28:56 remaining, estimate finish 2025-09-23 23:26:08]
28, 
[28:29 remaining, estimate finish 2025-09-23 23:26:03]
29, 
[28:10 remaining, estimate finish 2025-09-23 23:26:10]
30, 
[27:47 remaining, estimate finish 2025-09-23 23:26:12]
31, 
[27:20 remaining, estimate finish 2025-09-23 23:26:08]
32, 
[26:54 remaining, estimate finish 2025-09-23 23:26:06]
33, 
[26:36 remaining, estimate finish 2025-09-23 23:26:14]
34, 
[26:12 remaining, estimate finish 2025-09-23 23:26:15]
35, 
[25:39 remaining, estimate finish 2025-09-23 23:26:01]
36, 
[25:12 remaining, estimate finish 2025-09-23 23:25:56]
37, 
[24:46 remaining, estimate finish 2025-09-23 23:25:54]
38, 
[24:23 remaining, estimate finish 2025-09-23 23:25:55]
39, 
[23:57 remaining, estimate finish 2025-09-23 23:25:51]
40, 
[23:32 remaining, estimate finish 2025-09-23 23:25:50]
41, 
[23:14 remaining, estimate finish 2025-09-23 23:26:01]
42, 
[22:52 remaining, estimate finish 2025-09-23 23:26:03]
43, 
[22:30 remaining, estimate finish 2025-09-23 23:26:07]
44, 
[22:07 remaining, estimate finish 2025-09-23 23:26:09]
45, 
[21:43 remaining, estimate finish 2025-09-23 23:26:09]
46, 
[21:19 remaining, estimate finish 2025-09-23 23:26:10]
47, 
[21:00 remaining, estimate finish 2025-09-23 23:26:19]
48, 
[20:35 remaining, estimate finish 2025-09-23 23:26:18]
49, 
[20:10 remaining, estimate finish 2025-09-23 23:26:16]
50, 
[19:42 remaining, estimate finish 2025-09-23 23:26:08]
51, 
[19:18 remaining, estimate finish 2025-09-23 23:26:10]
52, 
[18:54 remaining, estimate finish 2025-09-23 23:26:09]
53, 
[18:31 remaining, estimate finish 2025-09-23 23:26:11]
54, 
[18:04 remaining, estimate finish 2025-09-23 23:26:05]
55, 
[17:40 remaining, estimate finish 2025-09-23 23:26:06]
56, 
[17:17 remaining, estimate finish 2025-09-23 23:26:08]
57, 
[16:53 remaining, estimate finish 2025-09-23 23:26:09]
58, 
[16:28 remaining, estimate finish 2025-09-23 23:26:06]
59, 
[16:06 remaining, estimate finish 2025-09-23 23:26:12]
60, 
[15:43 remaining, estimate finish 2025-09-23 23:26:13]
61, 
[15:17 remaining, estimate finish 2025-09-23 23:26:10]
62, 
[14:53 remaining, estimate finish 2025-09-23 23:26:10]
63, 
[14:26 remaining, estimate finish 2025-09-23 23:26:02]
64, 
[14:01 remaining, estimate finish 2025-09-23 23:26:01]
65, 
[13:37 remaining, estimate finish 2025-09-23 23:26:00]
66, 
[13:13 remaining, estimate finish 2025-09-23 23:25:59]
67, 
[12:47 remaining, estimate finish 2025-09-23 23:25:55]
68, 
[12:24 remaining, estimate finish 2025-09-23 23:25:56]
69, 
[12:01 remaining, estimate finish 2025-09-23 23:26:01]
70, 
[11:37 remaining, estimate finish 2025-09-23 23:26:02]
71, 
[11:14 remaining, estimate finish 2025-09-23 23:26:03]
72, 
[10:51 remaining, estimate finish 2025-09-23 23:26:07]
73, 
[10:27 remaining, estimate finish 2025-09-23 23:26:08]
74, 
[10:03 remaining, estimate finish 2025-09-23 23:26:08]
75,  [9:39 remaining] 76,  [9:15 remaining] 77,  [8:50 remaining] 78,  [8:25 remaining] 79,  [8:01 remaining] 80,  [7:37 remaining] 81,  [7:13 remaining] 82,  [6:49 remaining] 83,  [6:24 remaining] 84,  [6:00 remaining] 85,  [5:36 remaining] 86,  [5:12 remaining] 87,  [4:48 remaining] 88,  [4:24 remaining] 89,  [4:00 remaining] 90,  [3:36 remaining] 91,  [3:12 remaining] 92,  [2:47 remaining] 93,  [2:23 remaining] 94,
 [1:59 remaining] 95,  [1:36 remaining] 96,  [1:12 remaining] 97,  [48 sec remaining] 98,  [24 sec remaining] 
99.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_rest.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>At short distances (&lt;500m), the observed curve lies well above the CSR envelope, confirming statistically significant clustering of restaurants at the neighbourhood scale. At intermediate distances (500m–1km), the curve gradually declines toward the CSR expectation, suggesting that clustering effects are strongest only at localised ranges. Beyond ~1km, the observed curve generally falls within the CSR envelope, implying no significant departure from randomness at broader citywide scales. The L-function strengthens the conclusion from the K-function and KDE results — restaurant establishments in Singapore exhibit <strong>non-random clustering</strong> at short ranges, consistent with retail agglomeration in malls, food clusters, and transit-adjacent hubs.</p>
</section>
</section>
<section id="spatio-temporal-point-patterns-analysis" class="level3">
<h3 class="anchored" data-anchor-id="spatio-temporal-point-patterns-analysis">Spatio-Temporal Point Patterns Analysis</h3>
<p>Overall Plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz_cl)<span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(rest_biz_56111_sf) <span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="visualizing-geographic-distribution-of-restaurants-by-month" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-geographic-distribution-of-restaurants-by-month">Visualizing geographic distribution of restaurants by month</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz_cl)<span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(rest_biz_56111_sf) <span class="sc">+</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by=</span><span class="st">"MONTH_ABBR"</span>, </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">free.coords=</span><span class="cn">FALSE</span>, </span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">drop.units =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="computing-stkde-by-month" class="level4">
<h4 class="anchored" data-anchor-id="computing-stkde-by-month">Computing STKDE by Month</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>rest_month <span class="ot">&lt;-</span> rest_biz_56111_sf <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(MONTH_NUM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-ppp" class="level4">
<h4 class="anchored" data-anchor-id="creating-ppp">Creating PPP</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>rest_month_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(rest_month)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>rest_month_ppp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern: 677 points
marks are numeric, of storage type  'double'
window: rectangle = [7514.99, 46829.34] x [26622.47, 49432.98] units</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rest_month_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  677 points
Average intensity 7.549227e-07 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 11 decimal places

marks are numeric, of type 'double'
Summary:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   2.000   4.000   3.885   6.000   7.000 

Window: rectangle = [7514.99, 46829.34] x [26622.47, 49432.98] units
                    (39310 x 22810 units)
Window area = 896781000 square units</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(rest_month_ppp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="including-owin-object" class="level4">
<h4 class="anchored" data-anchor-id="including-owin-object">Including Owin object</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>rest_month_owin <span class="ot">&lt;-</span> rest_month_ppp[sg_owin]</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rest_month_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  677 points
Average intensity 1.011177e-06 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 11 decimal places

marks are numeric, of type 'double'
Summary:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   2.000   4.000   3.885   6.000   7.000 

Window: polygonal boundary
41 separate polygons (26 holes)
                  vertices         area relative.area
polygon 1              285  1.61128e+06      2.41e-03
polygon 2               27  1.50315e+04      2.25e-05
polygon 3 (hole)        41 -4.01660e+04     -6.00e-05
polygon 4 (hole)       317 -5.11280e+04     -7.64e-05
polygon 5 (hole)         3 -4.14100e-04     -6.19e-13
polygon 6               30  2.80002e+04      4.18e-05
polygon 7 (hole)         4 -2.86396e-01     -4.28e-10
polygon 8 (hole)         3 -1.81439e-04     -2.71e-13
polygon 9 (hole)         3 -5.99531e-04     -8.95e-13
polygon 10 (hole)        3 -3.04560e-04     -4.55e-13
polygon 11 (hole)        3 -4.46108e-04     -6.66e-13
polygon 12 (hole)        5 -2.44408e-04     -3.65e-13
polygon 13 (hole)        5 -3.64686e-02     -5.45e-11
polygon 14              71  8.18750e+03      1.22e-05
polygon 15 (hole)       38 -7.79904e+03     -1.16e-05
polygon 16              91  1.49663e+04      2.24e-05
polygon 17 (hole)      395 -7.38124e+03     -1.10e-05
polygon 18              40  1.38607e+04      2.07e-05
polygon 19 (hole)       11 -8.36705e+01     -1.25e-07
polygon 20 (hole)        3 -2.33435e-03     -3.49e-12
polygon 21              45  2.51218e+03      3.75e-06
polygon 22             139  3.22293e+03      4.81e-06
polygon 23             148  3.10395e+03      4.64e-06
polygon 24 (hole)        4 -1.72650e-04     -2.58e-13
polygon 25              75  1.73526e+04      2.59e-05
polygon 26              83  5.28920e+03      7.90e-06
polygon 27             106  3.04104e+03      4.54e-06
polygon 28              71  5.63061e+03      8.41e-06
polygon 29              10  1.99717e+02      2.98e-07
polygon 30 (hole)        3 -1.37223e-02     -2.05e-11
polygon 31 (hole)        3 -8.68789e-04     -1.30e-12
polygon 32 (hole)        3 -3.39815e-04     -5.08e-13
polygon 33 (hole)        3 -4.52041e-05     -6.75e-14
polygon 34 (hole)        3 -3.90173e-05     -5.83e-14
polygon 35 (hole)        3 -9.59845e-05     -1.43e-13
polygon 36 (hole)        8 -4.28707e-01     -6.40e-10
polygon 37 (hole)        4 -2.18619e-04     -3.27e-13
polygon 38 (hole)        6 -8.37554e-01     -1.25e-09
polygon 39 (hole)        5 -2.92235e-04     -4.36e-13
polygon 40           14053  6.67892e+08      9.98e-01
polygon 41 (hole)        3 -7.43616e-06     -1.11e-14
enclosing rectangle: [2667.54, 55941.94] x [21448.47, 50256.33] units
                     (53270 x 28810 units)
Window area = 669517000 square units
Fraction of frame area: 0.436</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rest_month_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="compute-spatio-temporal-kde" class="level4">
<h4 class="anchored" data-anchor-id="compute-spatio-temporal-kde">Compute Spatio-temporal KDE</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>rest_kde <span class="ot">&lt;-</span> <span class="fu">spattemp.density</span>(rest_month_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating trivariate smooth...Done.
Edge-correcting...Done.
Conditioning on time...Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rest_kde)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatiotemporal Kernel Density Estimate

Bandwidths
  h = 1575.134 (spatial)
  lambda = 0.0393 (temporal)

No. of observations
  677 

Spatial bound
  Type: polygonal
  2D enclosure: [2667.538, 55941.94] x [21448.47, 50256.33]

Temporal bound
  [1, 7]

Evaluation
  128 x 128 x 7 trivariate lattice
  Density range: [1.50514e-35, 5.14897e-08]</code></pre>
</div>
</div>
</section>
<section id="plotting-spatio-temporal-kde-object" class="level4">
<h4 class="anchored" data-anchor-id="plotting-spatio-temporal-kde-object">Plotting spatio-temporal KDE object</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>tims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> tims){ </span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(rest_kde, i, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">override.par=</span><span class="cn">FALSE</span>, </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fix.range=</span><span class="cn">TRUE</span>, </span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"KDE at month"</span>,i))</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="stpp-method" class="level4">
<h4 class="anchored" data-anchor-id="stpp-method">stpp Method</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>rest_coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(rest_biz_56111_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>rest_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> rest_coords[, <span class="dv">1</span>],  </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> rest_coords[, <span class="dv">2</span>],</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> rest_biz_56111_sf<span class="sc">$</span><span class="st">`</span><span class="at">date</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>rest_stpp <span class="ot">&lt;-</span> <span class="fu">as.3dpoints</span>(rest_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rest_stpp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="computing-spatio-temporal-k-function" class="level4">
<h4 class="anchored" data-anchor-id="computing-spatio-temporal-k-function">Computing spatio-temporal k-function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>rest_stik <span class="ot">&lt;-</span> <span class="fu">STIKhat</span>(rest_stpp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Space-time data contains duplicated points</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotK</span>(rest_stik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From the spatio-temporal analysis thus far, the STPP visualization, together with cumulative growth trends, confirms that restaurants in Singapore exhibit persistent, wave-like clustering across both geography and time, reflecting underlying economic and urban dynamics.</p>
<p>The point cloud shows heavy concentrations of restaurants within the central and commercial zones, consistent with earlier KDE findings, while the vertical axis (time) illustrates that new restaurants continue to emerge in successive waves, often reinforcing existing hotspots rather than dispersing to new locations.</p>
<p>Some districts (e.g., CBD, Orchard) consistently attract establishments across multiple time points, highlighting temporal persistence of clustering. When viewed along the time axis, the number of establishments is seen to rise cumulatively over the study period. Growth is unlikely to be uniform as there are periods of rapid expansion, followed by slower phases, suggesting the influence of broader economic or policy cycles.</p>
<p>Unlike the KDE, which smooths densities, the STPP visualization reveals the raw space–time dynamics of restaurant openings. It demonstrates that clustering is not only spatial but also temporally structured, with openings often concentrated in short bursts at specific hotspots. The cumulative increase over time underscores the steady expansion of the F&amp;B sector, while temporal fluctuations suggest the role of market saturation, urban redevelopment, and macroeconomic conditions.</p>
</section>
</section>
</section>
<section id="it-consultancy-business" class="level2">
<h2 class="anchored" data-anchor-id="it-consultancy-business">2. IT Consultancy Business</h2>
<section id="tidying-data-1" class="level3">
<h3 class="anchored" data-anchor-id="tidying-data-1">Tidying Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>IT_biz_62021 <span class="ot">&lt;-</span> acra_data <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(primary_ssic_code <span class="sc">==</span> <span class="dv">62021</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date =</span> registration_incorporation_date) <span class="sc">%&gt;%</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date),</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">YEAR =</span> <span class="fu">year</span>(date),</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">MONTH_NUM =</span> <span class="fu">month</span>(date),</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">MONTH_ABBR =</span> <span class="fu">month</span>(date,</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">abbr =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">postal_code =</span> <span class="fu">str_pad</span>(postal_code,</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">width =</span> <span class="dv">6</span>, <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">pad =</span> <span class="st">"0"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(YEAR <span class="sc">==</span> <span class="dv">2025</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="geocoding-1" class="level3">
<h3 class="anchored" data-anchor-id="geocoding-1">Geocoding</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>postcodes <span class="ot">&lt;-</span> <span class="fu">unique</span>(IT_biz_62021<span class="sc">$</span>postal_code)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>found <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>not_found <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">postcode =</span> <span class="fu">character</span>())</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://onemap.gov.sg/api/common/elastic/search"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pc <span class="cf">in</span> postcodes) {</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchVal =</span> pc,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">returnGeom =</span> <span class="st">"Y"</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">getAddrDetails =</span> <span class="st">"Y"</span>,</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageNum =</span> <span class="st">"1"</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(url, <span class="at">query =</span> query)</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>  json <span class="ot">&lt;-</span> <span class="fu">content</span>(res)</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (json<span class="sc">$</span>found <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(json<span class="sc">$</span>results, <span class="at">stringAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>input_postcode <span class="ot">&lt;-</span> pc</span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>    found <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(found, df)</span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>    not_found <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(not_found, <span class="fu">data.frame</span>(<span class="at">postcode =</span> pc))</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>IT_biz_62021 <span class="ot">=</span> IT_biz_62021 <span class="sc">%&gt;%</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(found,</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'postal_code'</span> <span class="ot">=</span> <span class="st">'POSTAL'</span>),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">relationship =</span> <span class="st">"many-to-many"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>IT_biz_62021_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(IT_biz_62021,</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"X"</span>,<span class="st">"Y"</span>),</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Save IT_biz_62021_sf file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(IT_biz_62021_sf, "data/rds/IT_biz_62021_sf.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="understanding-data-1" class="level3">
<h3 class="anchored" data-anchor-id="understanding-data-1">Understanding Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>IT_biz_62021_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/IT_biz_62021_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(IT_biz_62021_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 115 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 26060.88 ymin: 28954.42 xmax: 31115.4 ymax: 47195.49
Projected CRS: SVY21 / Singapore TM
# A tibble: 6 × 116
  uen        issuance_agency_id entity_name               entity_type_descript…¹
  &lt;chr&gt;      &lt;chr&gt;              &lt;chr&gt;                     &lt;chr&gt;                 
1 202500022N ACRA               AIDREO PTE. LTD.          Local Company         
2 202500086N ACRA               APPSEDU  PTE. LTD.        Local Company         
3 202501181K ACRA               AI WISE PTE. LTD.         Local Company         
4 202501436E ACRA               ASSEMBLY SYNERGY PTE. LT… Local Company         
5 202501708M ACRA               AVATARA PTE. LTD.         Local Company         
6 202501821R ACRA               ASYAI PTE. LTD.           Local Company         
# ℹ abbreviated name: ¹​entity_type_description
# ℹ 112 more variables: business_constitution_description &lt;chr&gt;,
#   company_type_description &lt;chr&gt;, paf_constitution_description &lt;chr&gt;,
#   entity_status_description &lt;chr&gt;, date &lt;date&gt;, uen_issue_date &lt;date&gt;,
#   address_type &lt;chr&gt;, block &lt;chr&gt;, street_name &lt;chr&gt;, level_no &lt;chr&gt;,
#   unit_no &lt;chr&gt;, building_name &lt;chr&gt;, postal_code &lt;chr&gt;,
#   other_address_line1 &lt;chr&gt;, other_address_line2 &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Number of businesses</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of businesses</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(IT_biz_62021_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 950</code></pre>
</div>
</div>
<p>Plotting data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(IT_biz_62021_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: plotting the first 9 out of 115 attributes; use max.plot = 115 to plot
all</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="convert-sf-dataframe-to-ppp-class-1" class="level3">
<h3 class="anchored" data-anchor-id="convert-sf-dataframe-to-ppp-class-1">Convert sf dataframe to ppp class</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>IT_biz_62021_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(IT_biz_62021_sf)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(IT_biz_62021_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ppp"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(IT_biz_62021_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern object</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  950 points
Average intensity 1.331899e-06 points per square unit

Coordinates are given to 10 decimal places

Mark variables: uen, issuance_agency_id, entity_name, entity_type_description, 
business_constitution_description, company_type_description, 
paf_constitution_description, entity_status_description, date, uen_issue_date, 
address_type, block, street_name, level_no, unit_no, building_name, 
postal_code, other_address_line1, other_address_line2, account_due_date, 
annual_return_date, primary_ssic_code, primary_ssic_description, 
primary_user_described_activity, YEAR, MONTH_NUM, MONTH_ABBR, SEARCHVAL, 
BLK_NO, ROAD_NAME, BUILDING, ADDRESS, LATITUDE, LONGITUDE, SEARCHVAL.1, 
BLK_NO.1, ROAD_NAME.1, BUILDING.1, ADDRESS.1, POSTAL.1, X.1, Y.1, LATITUDE.1, 
LONGITUDE.1, input_postcode, SEARCHVAL.2, BLK_NO.2, ROAD_NAME.2, BUILDING.2, 
ADDRESS.2, POSTAL.2, X.2, Y.2, LATITUDE.2, LONGITUDE.2, SEARCHVAL.3, BLK_NO.3, 
ROAD_NAME.3, BUILDING.3, ADDRESS.3, POSTAL.3, X.3, Y.3, LATITUDE.3, 
LONGITUDE.3, SEARCHVAL.4, BLK_NO.4, ROAD_NAME.4, BUILDING.4, ADDRESS.4, 
POSTAL.4, X.4, Y.4, LATITUDE.4, LONGITUDE.4, SEARCHVAL.5, BLK_NO.5, 
ROAD_NAME.5, BUILDING.5, ADDRESS.5, POSTAL.5, X.5, Y.5, LATITUDE.5, 
LONGITUDE.5, SEARCHVAL.6, BLK_NO.6, ROAD_NAME.6, BUILDING.6, ADDRESS.6, 
POSTAL.6, X.6, Y.6, LATITUDE.6, LONGITUDE.6, SEARCHVAL.7, BLK_NO.7, 
ROAD_NAME.7, BUILDING.7, ADDRESS.7, POSTAL.7, X.7, Y.7, LATITUDE.7, 
LONGITUDE.7, SEARCHVAL.8, BLK_NO.8, ROAD_NAME.8, BUILDING.8, ADDRESS.8, 
POSTAL.8, X.8, Y.8, LATITUDE.8, LONGITUDE.8
Summary:
     uen            issuance_agency_id entity_name       
 Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character  
                                                         
                                                         
                                                         
                                                         
 entity_type_description business_constitution_description
 Length:950              Length:950                       
 Class :character        Class :character                 
 Mode  :character        Mode  :character                 
                                                          
                                                          
                                                          
                                                          
 company_type_description paf_constitution_description
 Length:950               Length:950                  
 Class :character         Class :character            
 Mode  :character         Mode  :character            
                                                      
                                                      
                                                      
                                                      
 entity_status_description      date            uen_issue_date      
 Length:950                Min.   :2025-01-01   Min.   :2025-01-01  
 Class :character          1st Qu.:2025-02-21   1st Qu.:2025-02-24  
 Mode  :character          Median :2025-04-15   Median :2025-04-15  
                           Mean   :2025-04-14   Mean   :2025-04-14  
                           3rd Qu.:2025-06-02   3rd Qu.:2025-06-02  
                           Max.   :2025-07-31   Max.   :2025-07-31  
                                                                    
 address_type          block           street_name          level_no        
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
   unit_no          building_name      postal_code        other_address_line1
 Length:950         Length:950         Length:950         Length:950         
 Class :character   Class :character   Class :character   Class :character   
 Mode  :character   Mode  :character   Mode  :character   Mode  :character   
                                                                             
                                                                             
                                                                             
                                                                             
 other_address_line2 account_due_date   annual_return_date primary_ssic_code
 Length:950          Length:950         Length:950         Min.   :62021    
 Class :character    Class :character   Class :character   1st Qu.:62021    
 Mode  :character    Mode  :character   Mode  :character   Median :62021    
                                                           Mean   :62021    
                                                           3rd Qu.:62021    
                                                           Max.   :62021    
                                                                            
 primary_ssic_description primary_user_described_activity      YEAR     
 Length:950               Length:950                      Min.   :2025  
 Class :character         Class :character                1st Qu.:2025  
 Mode  :character         Mode  :character                Median :2025  
                                                          Mean   :2025  
                                                          3rd Qu.:2025  
                                                          Max.   :2025  
                                                                        
   MONTH_NUM       MONTH_ABBR   SEARCHVAL            BLK_NO         
 Min.   :1.000   May    :158   Length:950         Length:950        
 1st Qu.:2.000   Jan    :147   Class :character   Class :character  
 Median :4.000   Apr    :138   Mode  :character   Mode  :character  
 Mean   :3.953   Jul    :135                                        
 3rd Qu.:6.000   Feb    :131                                        
 Max.   :7.000   Mar    :129                                        
                 (Other):112                                        
  ROAD_NAME           BUILDING           ADDRESS            LATITUDE        
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  LONGITUDE         SEARCHVAL.1          BLK_NO.1         ROAD_NAME.1       
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  BUILDING.1         ADDRESS.1           POSTAL.1             X.1           
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     Y.1             LATITUDE.1        LONGITUDE.1        input_postcode    
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 SEARCHVAL.2          BLK_NO.2         ROAD_NAME.2         BUILDING.2       
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  ADDRESS.2           POSTAL.2             X.2                Y.2           
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  LATITUDE.2        LONGITUDE.2        SEARCHVAL.3          BLK_NO.3        
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 ROAD_NAME.3         BUILDING.3         ADDRESS.3           POSTAL.3        
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     X.3                Y.3             LATITUDE.3        LONGITUDE.3       
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 SEARCHVAL.4          BLK_NO.4         ROAD_NAME.4         BUILDING.4       
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  ADDRESS.4           POSTAL.4             X.4                Y.4           
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  LATITUDE.4        LONGITUDE.4        SEARCHVAL.5          BLK_NO.5        
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 ROAD_NAME.5         BUILDING.5         ADDRESS.5           POSTAL.5        
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     X.5                Y.5             LATITUDE.5        LONGITUDE.5       
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 SEARCHVAL.6          BLK_NO.6         ROAD_NAME.6         BUILDING.6       
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  ADDRESS.6           POSTAL.6             X.6                Y.6           
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  LATITUDE.6        LONGITUDE.6        SEARCHVAL.7          BLK_NO.7        
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 ROAD_NAME.7         BUILDING.7         ADDRESS.7           POSTAL.7        
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     X.7                Y.7             LATITUDE.7        LONGITUDE.7       
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 SEARCHVAL.8          BLK_NO.8         ROAD_NAME.8         BUILDING.8       
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  ADDRESS.8           POSTAL.8             X.8                Y.8           
 Length:950         Length:950         Length:950         Length:950        
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  LATITUDE.8        LONGITUDE.8       
 Length:950         Length:950        
 Class :character   Class :character  
 Mode  :character   Mode  :character  
                                      
                                      
                                      
                                      

Window: rectangle = [8396.53, 43001.3] x [28409.52, 49021.35] units
                    (34600 x 20610 units)
Window area = 713268000 square units</code></pre>
</div>
</div>
</section>
<section id="create-owin-object-1" class="level3">
<h3 class="anchored" data-anchor-id="create-owin-object-1">Create owin object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>mpsz_cl <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mpsz_cl.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>sg_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(mpsz_cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sg_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combine-point-events-object-and-owin-object-1" class="level3">
<h3 class="anchored" data-anchor-id="combine-point-events-object-and-owin-object-1">Combine point events object and owin object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>IT_biz_62021_ppp <span class="ot">=</span> IT_biz_62021_ppp[sg_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>IT_biz_62021_ppp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern x</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern: 950 points
Mark variables: 
   uen issuance_agency_id entity_name entity_type_description 
business_constitution_description company_type_description 
paf_constitution_description entity_status_description date uen_issue_date 
address_type block street_name level_no unit_no building_name postal_code 
other_address_line1 other_address_line2 account_due_date annual_return_date 
primary_ssic_code primary_ssic_description primary_user_described_activity YEAR 
MONTH_NUM MONTH_ABBR SEARCHVAL BLK_NO ROAD_NAME BUILDING ADDRESS LATITUDE 
LONGITUDE SEARCHVAL.1 BLK_NO.1 ROAD_NAME.1 BUILDING.1 ADDRESS.1 POSTAL.1 X.1 
Y.1 LATITUDE.1 LONGITUDE.1 input_postcode SEARCHVAL.2 BLK_NO.2 ROAD_NAME.2 
BUILDING.2 ADDRESS.2 POSTAL.2 X.2 Y.2 LATITUDE.2 LONGITUDE.2 SEARCHVAL.3 
BLK_NO.3 ROAD_NAME.3 BUILDING.3 ADDRESS.3 POSTAL.3 X.3 Y.3 LATITUDE.3 
LONGITUDE.3 SEARCHVAL.4 BLK_NO.4 ROAD_NAME.4 BUILDING.4 ADDRESS.4 POSTAL.4 X.4 
Y.4 LATITUDE.4 LONGITUDE.4 SEARCHVAL.5 BLK_NO.5 ROAD_NAME.5 BUILDING.5 
ADDRESS.5 POSTAL.5 X.5 Y.5 LATITUDE.5 LONGITUDE.5 SEARCHVAL.6 BLK_NO.6 
ROAD_NAME.6 BUILDING.6 ADDRESS.6 POSTAL.6 X.6 Y.6 LATITUDE.6 LONGITUDE.6 
SEARCHVAL.7 BLK_NO.7 ROAD_NAME.7 BUILDING.7 ADDRESS.7 POSTAL.7 X.7 Y.7 
LATITUDE.7 LONGITUDE.7 SEARCHVAL.8 BLK_NO.8 ROAD_NAME.8 BUILDING.8 ADDRESS.8 
POSTAL.8 X.8 Y.8 LATITUDE.8 LONGITUDE.8
window: polygonal boundary
enclosing rectangle: [2667.54, 55941.94] x [21448.47, 50256.33] units</code></pre>
</div>
</div>
</section>
<section id="clark-evan-test-for-nearest-neighbour-analysis-1" class="level3">
<h3 class="anchored" data-anchor-id="clark-evan-test-for-nearest-neighbour-analysis-1">Clark-Evan Test for Nearest Neighbour Analysis</h3>
<p>Without CSR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(IT_biz_62021_ppp,</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clark-Evans test
    No edge correction
    Z-test

data:  IT_biz_62021_ppp
R = 0.35105, p-value &lt; 2.2e-16
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
<p>With CSR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(IT_biz_62021_ppp,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">method=</span><span class="st">"MonteCarlo"</span>,</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clark-Evans test
    No edge correction
    Monte Carlo test based on 99 simulations of CSR with fixed n

data:  IT_biz_62021_ppp
R = 0.35105, p-value = 0.01
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
<p>Taking a 95% confidence level, the Clark-Evans test showed that p-value were consistently below the threshold &lt; 0.05, indicating that restaurants are not randomly distributed.</p>
</section>
<section id="kernel-density-estimation-1" class="level3">
<h3 class="anchored" data-anchor-id="kernel-density-estimation-1">Kernel Density Estimation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>IT_biz_62021_ppp_km <span class="ot">&lt;-</span> <span class="fu">rescale.ppp</span>(</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  IT_biz_62021_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>it_kde_SG_diggle <span class="ot">&lt;-</span> <span class="fu">density</span>(</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  IT_biz_62021_ppp_km,</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel=</span><span class="st">"gaussian"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(it_kde_SG_diggle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(it_kde_SG_diggle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>real-valued pixel image
128 x 128 pixel array (ny, nx)
enclosing rectangle: [2.667538, 55.94194] x [21.44847, 50.25633] km
dimensions of each pixel: 0.416 x 0.2250614 km
Image is defined on a subset of the rectangular grid
Subset area = 669.941961122495 square km
Subset area fraction = 0.437
Pixel values (inside window):
    range = [-1.182249e-13, 1131.608]
    integral = 950
    mean = 1.418033</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">bw.diggle</span>(IT_biz_62021_ppp_km)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>bw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      sigma 
0.007046933 </code></pre>
</div>
</div>
</section>
<section id="nd-order-spatial-point-pattern-analysis-1" class="level3">
<h3 class="anchored" data-anchor-id="nd-order-spatial-point-pattern-analysis-1">2nd Order Spatial Point Pattern Analysis</h3>
<section id="using-k-function-1" class="level4">
<h4 class="anchored" data-anchor-id="using-k-function-1">Using K-Function</h4>
<p>Computing K-Function estimate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>K_it <span class="ot">=</span> <span class="fu">Kest</span>(IT_biz_62021_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_it, . <span class="sc">-</span>r <span class="sc">~</span> r, <span class="at">ylab=</span> <span class="st">"K(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Performing Complete Spatial Randomness Test</strong></p>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<p>Ho = The distribution of IT consultancy services in Singapore are randomly distributed.</p>
<p>H1= The distribution of IT consultancy services in Singapore are not randomly distributed.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>K_it.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(IT_biz_62021_ppp, Kest, <span class="at">nsim =</span> <span class="dv">99</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">glocal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern Y</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern object</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 
[1:17:29 remaining, estimate finish 2025-09-24 00:53:36]
3, 
[1:13:21 remaining, estimate finish 2025-09-24 00:50:12]
4, 
[1:14:06 remaining, estimate finish 2025-09-24 00:51:46]
5, 
[1:13:17 remaining, estimate finish 2025-09-24 00:51:43]
6, 
[1:12:42 remaining, estimate finish 2025-09-24 00:51:56]
7, 
[1:11:55 remaining, estimate finish 2025-09-24 00:51:55]
8, 
[1:11:24 remaining, estimate finish 2025-09-24 00:52:13]
9, 
[1:11:40 remaining, estimate finish 2025-09-24 00:53:22]
10, 
[1:11:05 remaining, estimate finish 2025-09-24 00:53:35]
11, 
[1:11:08 remaining, estimate finish 2025-09-24 00:54:32]
12, 
[1:10:46 remaining, estimate finish 2025-09-24 00:55:02]
13, 
[1:09:05 remaining, estimate finish 2025-09-24 00:54:02]
14, 
[1:07:50 remaining, estimate finish 2025-09-24 00:53:32]
15, 
[1:06:34 remaining, estimate finish 2025-09-24 00:52:58]
16, 
[1:05:23 remaining, estimate finish 2025-09-24 00:52:31]
17, 
[1:04:30 remaining, estimate finish 2025-09-24 00:52:24]
18, 
[1:03:08 remaining, estimate finish 2025-09-24 00:51:42]
19, 
[1:01:55 remaining, estimate finish 2025-09-24 00:51:10]
20, 
[1:01:02 remaining, estimate finish 2025-09-24 00:51:02]
21, 
[1:00:12 remaining, estimate finish 2025-09-24 00:50:57]
22, 
[59:08 remaining, estimate finish 2025-09-24 00:50:34]
23, 
[58:12 remaining, estimate finish 2025-09-24 00:50:21]
24, 
[57:28 remaining, estimate finish 2025-09-24 00:50:24]
25, 
[56:34 remaining, estimate finish 2025-09-24 00:50:14]
26, 
[56:05 remaining, estimate finish 2025-09-24 00:50:36]
27, 
[55:11 remaining, estimate finish 2025-09-24 00:50:26]
28, 
[54:25 remaining, estimate finish 2025-09-24 00:50:25]
29, 
[53:35 remaining, estimate finish 2025-09-24 00:50:20]
30, 
[53:33 remaining, estimate finish 2025-09-24 00:51:22]
31, 
[57:23 remaining, estimate finish 2025-09-24 00:58:01]
32, 
[56:34 remaining, estimate finish 2025-09-24 00:58:04]
33, 
[55:32 remaining, estimate finish 2025-09-24 00:57:46]
34, 
[54:28 remaining, estimate finish 2025-09-24 00:57:26]
35, 
[53:19 remaining, estimate finish 2025-09-24 00:56:58]
36, 
[52:12 remaining, estimate finish 2025-09-24 00:56:31]
37, 
[51:23 remaining, estimate finish 2025-09-24 00:56:32]
38, 
[50:23 remaining, estimate finish 2025-09-24 00:56:15]
39, 
[49:14 remaining, estimate finish 2025-09-24 00:55:43]
40, 
[48:21 remaining, estimate finish 2025-09-24 00:55:37]
41, 
[47:37 remaining, estimate finish 2025-09-24 00:55:45]
42, 
[46:52 remaining, estimate finish 2025-09-24 00:55:54]
43, 
[46:02 remaining, estimate finish 2025-09-24 00:55:52]
44, 
[45:12 remaining, estimate finish 2025-09-24 00:55:51]
45, 
[44:17 remaining, estimate finish 2025-09-24 00:55:40]
46, 
[43:16 remaining, estimate finish 2025-09-24 00:55:19]
47, 
[42:23 remaining, estimate finish 2025-09-24 00:55:12]
48, 
[41:36 remaining, estimate finish 2025-09-24 00:55:16]
49, 
[40:45 remaining, estimate finish 2025-09-24 00:55:12]
50, 
[39:48 remaining, estimate finish 2025-09-24 00:54:55]
51, 
[38:55 remaining, estimate finish 2025-09-24 00:54:46]
52, 
[38:01 remaining, estimate finish 2025-09-24 00:54:34]
53, 
[37:07 remaining, estimate finish 2025-09-24 00:54:24]
54, 
[36:09 remaining, estimate finish 2025-09-24 00:54:02]
55, 
[35:15 remaining, estimate finish 2025-09-24 00:53:50]
56, 
[34:26 remaining, estimate finish 2025-09-24 00:53:47]
57, 
[33:30 remaining, estimate finish 2025-09-24 00:53:30]
58, 
[33:05 remaining, estimate finish 2025-09-24 00:54:24]
59, 
[43:45 remaining, estimate finish 2025-09-24 01:22:29]
60, 
[42:23 remaining, estimate finish 2025-09-24 01:21:50]
61, 
[41:03 remaining, estimate finish 2025-09-24 01:21:10]
62, 
[39:42 remaining, estimate finish 2025-09-24 01:20:28]
63, 
[38:31 remaining, estimate finish 2025-09-24 01:20:10]
64, 
[41:17 remaining, estimate finish 2025-09-24 01:30:53]
65, 
[39:47 remaining, estimate finish 2025-09-24 01:29:58]
66, 
[43:37 remaining, estimate finish 2025-09-24 01:44:51]
67, 
[49:22 remaining, estimate finish 2025-09-24 02:06:30]
68, 
[54:23 remaining, estimate finish 2025-09-24 02:27:14]
69, 
[59:00 remaining, estimate finish 2025-09-24 02:48:02]
70, 
[1:03:13 remaining, estimate finish 2025-09-24 03:08:58]
71, 
[1:00:28 remaining, estimate finish 2025-09-24 03:06:56]
72, 
[58:28 remaining, estimate finish 2025-09-24 03:07:30]
73, 
[59:56 remaining, estimate finish 2025-09-24 03:21:12]
74, 
[57:04 remaining, estimate finish 2025-09-24 03:18:59]
75, 
[54:14 remaining, estimate finish 2025-09-24 03:16:47]
76, 
[51:28 remaining, estimate finish 2025-09-24 03:14:36]
77, 
[48:46 remaining, estimate finish 2025-09-24 03:12:34]
78, 
[46:09 remaining, estimate finish 2025-09-24 03:10:39]
79, 
[43:34 remaining, estimate finish 2025-09-24 03:08:48]
80, 
[41:02 remaining, estimate finish 2025-09-24 03:06:58]
81, 
[38:33 remaining, estimate finish 2025-09-24 03:05:12]
82, 
[36:07 remaining, estimate finish 2025-09-24 03:03:30]
83, 
[33:43 remaining, estimate finish 2025-09-24 03:01:51]
84, 
[31:22 remaining, estimate finish 2025-09-24 03:00:17]
85, 
[29:04 remaining, estimate finish 2025-09-24 02:58:50]
86, 
[26:47 remaining, estimate finish 2025-09-24 02:57:13]
87, 
[24:32 remaining, estimate finish 2025-09-24 02:55:41]
88, 
[22:20 remaining, estimate finish 2025-09-24 02:54:18]
89, 
[20:09 remaining, estimate finish 2025-09-24 02:52:51]
90, 
[18:02 remaining, estimate finish 2025-09-24 02:51:36]
91, 
[15:55 remaining, estimate finish 2025-09-24 02:50:14]
92, 
[13:50 remaining, estimate finish 2025-09-24 02:49:00]
93, 
[11:47 remaining, estimate finish 2025-09-24 02:47:41]
94,  [9:45 remaining] 95,  [7:45 remaining] 96,  [5:46 remaining] 97,  [3:50 remaining] 98,  [1:54 remaining] 
99.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_it.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"K(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="using-l-function-1" class="level4">
<h4 class="anchored" data-anchor-id="using-l-function-1">Using L-Function</h4>
<p>Computing L Function estimate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>L_it <span class="ot">=</span> <span class="fu">Lest</span>(IT_biz_62021_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_it, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-80-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Performing Complete Spatial Randomness Test</strong></p>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<p>Ho = The distribution of IT consultancy services in Singapore are randomly distributed.</p>
<p>H1= The distribution of IT consultancy services in Singapore are not randomly distributed.</p>
<p>The null hypothesis will be rejected if p-value if smaller than alpha value of 0.001.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>L_it.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(IT_biz_62021_ppp, Lest, <span class="at">nsim =</span> <span class="dv">99</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">glocal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern Y</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern object</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 
[1:09:47 remaining, estimate finish 2025-09-24 03:55:41]
3, 
[1:09:57 remaining, estimate finish 2025-09-24 03:56:36]
4, 
[1:10:04 remaining, estimate finish 2025-09-24 03:57:27]
5, 
[1:10:23 remaining, estimate finish 2025-09-24 03:58:33]
6, 
[1:10:38 remaining, estimate finish 2025-09-24 03:59:37]
7, 
[1:08:50 remaining, estimate finish 2025-09-24 03:58:31]
8, 
[1:08:14 remaining, estimate finish 2025-09-24 03:58:40]
9, 
[1:07:26 remaining, estimate finish 2025-09-24 03:58:36]
10, 
[1:06:10 remaining, estimate finish 2025-09-24 03:58:03]
11, 
[1:05:10 remaining, estimate finish 2025-09-24 03:57:45]
12, 
[1:03:10 remaining, estimate finish 2025-09-24 03:56:20]
13, 
[1:02:25 remaining, estimate finish 2025-09-24 03:56:18]
14, 
[1:01:11 remaining, estimate finish 2025-09-24 03:55:43]
15, 
[59:45 remaining, estimate finish 2025-09-24 03:54:54]
16, 
[58:35 remaining, estimate finish 2025-09-24 03:54:22]
17, 
[57:58 remaining, estimate finish 2025-09-24 03:54:28]
18, 
[57:05 remaining, estimate finish 2025-09-24 03:54:15]
19, 
[56:12 remaining, estimate finish 2025-09-24 03:54:02]
20, 
[55:30 remaining, estimate finish 2025-09-24 03:54:02]
21, 
[54:48 remaining, estimate finish 2025-09-24 03:54:02]
22, 
[53:56 remaining, estimate finish 2025-09-24 03:53:50]
23, 
[53:11 remaining, estimate finish 2025-09-24 03:53:46]
24, 
[52:13 remaining, estimate finish 2025-09-24 03:53:25]
25, 
[51:18 remaining, estimate finish 2025-09-24 03:53:07]
26, 
[50:26 remaining, estimate finish 2025-09-24 03:52:54]
27, 
[49:38 remaining, estimate finish 2025-09-24 03:52:45]
28, 
[48:48 remaining, estimate finish 2025-09-24 03:52:33]
29, 
[48:03 remaining, estimate finish 2025-09-24 03:52:28]
30, 
[47:13 remaining, estimate finish 2025-09-24 03:52:15]
31, 
[46:41 remaining, estimate finish 2025-09-24 03:52:28]
32, 
[46:05 remaining, estimate finish 2025-09-24 03:52:36]
33, 
[45:21 remaining, estimate finish 2025-09-24 03:52:32]
34, 
[44:29 remaining, estimate finish 2025-09-24 03:52:14]
35, 
[43:41 remaining, estimate finish 2025-09-24 03:52:04]
36, 
[43:00 remaining, estimate finish 2025-09-24 03:52:05]
37, 
[42:07 remaining, estimate finish 2025-09-24 03:51:46]
38, 
[41:26 remaining, estimate finish 2025-09-24 03:51:46]
39, 
[40:44 remaining, estimate finish 2025-09-24 03:51:43]
40, 
[39:54 remaining, estimate finish 2025-09-24 03:51:28]
41, 
[39:22 remaining, estimate finish 2025-09-24 03:51:41]
42, 
[38:41 remaining, estimate finish 2025-09-24 03:51:41]
43, 
[38:01 remaining, estimate finish 2025-09-24 03:51:42]
44, 
[37:18 remaining, estimate finish 2025-09-24 03:51:38]
45, 
[36:38 remaining, estimate finish 2025-09-24 03:51:40]
46, 
[35:59 remaining, estimate finish 2025-09-24 03:51:43]
47, 
[35:19 remaining, estimate finish 2025-09-24 03:51:45]
48, 
[34:39 remaining, estimate finish 2025-09-24 03:51:45]
49, 
[33:55 remaining, estimate finish 2025-09-24 03:51:40]
50, 
[33:09 remaining, estimate finish 2025-09-24 03:51:28]
51, 
[32:29 remaining, estimate finish 2025-09-24 03:51:30]
52, 
[31:46 remaining, estimate finish 2025-09-24 03:51:24]
53, 
[31:03 remaining, estimate finish 2025-09-24 03:51:21]
54, 
[30:19 remaining, estimate finish 2025-09-24 03:51:12]
55, 
[29:38 remaining, estimate finish 2025-09-24 03:51:10]
56, 
[28:58 remaining, estimate finish 2025-09-24 03:51:12]
57, 
[28:16 remaining, estimate finish 2025-09-24 03:51:09]
58, 
[40:09 remaining, estimate finish 2025-09-24 04:21:08]
59, 
[38:57 remaining, estimate finish 2025-09-24 04:20:38]
60, 
[37:49 remaining, estimate finish 2025-09-24 04:20:14]
61, 
[36:45 remaining, estimate finish 2025-09-24 04:19:57]
62, 
[35:38 remaining, estimate finish 2025-09-24 04:19:34]
63, 
[34:32 remaining, estimate finish 2025-09-24 04:19:11]
64, 
[33:26 remaining, estimate finish 2025-09-24 04:18:48]
65, 
[32:23 remaining, estimate finish 2025-09-24 04:18:31]
66, 
[31:20 remaining, estimate finish 2025-09-24 04:18:14]
67, 
[30:18 remaining, estimate finish 2025-09-24 04:17:59]
68, 
[29:15 remaining, estimate finish 2025-09-24 04:17:39]
69, 
[28:13 remaining, estimate finish 2025-09-24 04:17:22]
70, 
[27:12 remaining, estimate finish 2025-09-24 04:17:07]
71, 
[26:11 remaining, estimate finish 2025-09-24 04:16:49]
72, 
[25:14 remaining, estimate finish 2025-09-24 04:16:47]
73, 
[24:15 remaining, estimate finish 2025-09-24 04:16:36]
74, 
[23:16 remaining, estimate finish 2025-09-24 04:16:23]
75, 
[22:18 remaining, estimate finish 2025-09-24 04:16:16]
76, 
[21:21 remaining, estimate finish 2025-09-24 04:16:08]
77, 
[20:22 remaining, estimate finish 2025-09-24 04:15:56]
78, 
[19:24 remaining, estimate finish 2025-09-24 04:15:45]
79, 
[18:27 remaining, estimate finish 2025-09-24 04:15:37]
80, 
[17:31 remaining, estimate finish 2025-09-24 04:15:30]
81, 
[16:33 remaining, estimate finish 2025-09-24 04:15:19]
82, 
[15:36 remaining, estimate finish 2025-09-24 04:15:10]
83, 
[14:39 remaining, estimate finish 2025-09-24 04:14:57]
84, 
[13:43 remaining, estimate finish 2025-09-24 04:14:51]
85, 
[12:47 remaining, estimate finish 2025-09-24 04:14:39]
86, 
[11:51 remaining, estimate finish 2025-09-24 04:14:32]
87, 
[10:55 remaining, estimate finish 2025-09-24 04:14:18]
88,  [9:59 remaining] 89,  [9:04 remaining] 90,  [8:08 remaining] 91,  [7:13 remaining] 92,  [6:19 remaining] 93,  [5:24 remaining] 94,  [4:29 remaining] 95,  [3:35 remaining] 96,  [2:41 remaining] 97,  [1:47 remaining] 98,  [54 sec remaining] 
99.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_it.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ripley’s K and L‐function for IT consultancy show clustering at short to moderate distances (approx. 500-1000 m), but the deviation from CSR (Complete Spatial Randomness) is smaller in magnitude than for restaurants. The observed L(d)−d curve breaches the CSR envelope for small distances, implying statistically significant clustering, but the envelope return to near zero at wider spatial scales suggests that clustering does not persist at larger scales. The pair correlation function, if calculated, likely shows peaks around those same short distances.</p>
</section>
</section>
<section id="spatio-temporal-point-patterns-analysis-1" class="level3">
<h3 class="anchored" data-anchor-id="spatio-temporal-point-patterns-analysis-1">Spatio-Temporal Point Patterns Analysis</h3>
<p>Overall Plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz_cl)<span class="sc">+</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(IT_biz_62021_sf) <span class="sc">+</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="visualizing-geographic-distribution-of-restaurants-by-month-1" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-geographic-distribution-of-restaurants-by-month-1">Visualizing geographic distribution of restaurants by month</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz_cl)<span class="sc">+</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(IT_biz_62021_sf) <span class="sc">+</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by=</span><span class="st">"MONTH_ABBR"</span>, </span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">free.coords=</span><span class="cn">FALSE</span>, </span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">drop.units =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="computing-stkde-by-month-1" class="level4">
<h4 class="anchored" data-anchor-id="computing-stkde-by-month-1">Computing STKDE by Month</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>it_month <span class="ot">&lt;-</span> IT_biz_62021_sf <span class="sc">%&gt;%</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(MONTH_NUM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-ppp-1" class="level4">
<h4 class="anchored" data-anchor-id="creating-ppp-1">Creating PPP</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>it_month_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(it_month)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>it_month_ppp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern: 950 points
marks are numeric, of storage type  'double'
window: rectangle = [8396.53, 43001.3] x [28409.52, 49021.35] units</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(it_month_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  950 points
Average intensity 1.331899e-06 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 10 decimal places

marks are numeric, of type 'double'
Summary:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   2.000   4.000   3.953   6.000   7.000 

Window: rectangle = [8396.53, 43001.3] x [28409.52, 49021.35] units
                    (34600 x 20610 units)
Window area = 713268000 square units</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(it_month_ppp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="including-owin-object-1" class="level4">
<h4 class="anchored" data-anchor-id="including-owin-object-1">Including Owin object</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>it_month_owin <span class="ot">&lt;-</span> it_month_ppp[sg_owin]</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(it_month_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  950 points
Average intensity 1.418934e-06 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 10 decimal places

marks are numeric, of type 'double'
Summary:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   2.000   4.000   3.953   6.000   7.000 

Window: polygonal boundary
41 separate polygons (26 holes)
                  vertices         area relative.area
polygon 1              285  1.61128e+06      2.41e-03
polygon 2               27  1.50315e+04      2.25e-05
polygon 3 (hole)        41 -4.01660e+04     -6.00e-05
polygon 4 (hole)       317 -5.11280e+04     -7.64e-05
polygon 5 (hole)         3 -4.14100e-04     -6.19e-13
polygon 6               30  2.80002e+04      4.18e-05
polygon 7 (hole)         4 -2.86396e-01     -4.28e-10
polygon 8 (hole)         3 -1.81439e-04     -2.71e-13
polygon 9 (hole)         3 -5.99531e-04     -8.95e-13
polygon 10 (hole)        3 -3.04560e-04     -4.55e-13
polygon 11 (hole)        3 -4.46108e-04     -6.66e-13
polygon 12 (hole)        5 -2.44408e-04     -3.65e-13
polygon 13 (hole)        5 -3.64686e-02     -5.45e-11
polygon 14              71  8.18750e+03      1.22e-05
polygon 15 (hole)       38 -7.79904e+03     -1.16e-05
polygon 16              91  1.49663e+04      2.24e-05
polygon 17 (hole)      395 -7.38124e+03     -1.10e-05
polygon 18              40  1.38607e+04      2.07e-05
polygon 19 (hole)       11 -8.36705e+01     -1.25e-07
polygon 20 (hole)        3 -2.33435e-03     -3.49e-12
polygon 21              45  2.51218e+03      3.75e-06
polygon 22             139  3.22293e+03      4.81e-06
polygon 23             148  3.10395e+03      4.64e-06
polygon 24 (hole)        4 -1.72650e-04     -2.58e-13
polygon 25              75  1.73526e+04      2.59e-05
polygon 26              83  5.28920e+03      7.90e-06
polygon 27             106  3.04104e+03      4.54e-06
polygon 28              71  5.63061e+03      8.41e-06
polygon 29              10  1.99717e+02      2.98e-07
polygon 30 (hole)        3 -1.37223e-02     -2.05e-11
polygon 31 (hole)        3 -8.68789e-04     -1.30e-12
polygon 32 (hole)        3 -3.39815e-04     -5.08e-13
polygon 33 (hole)        3 -4.52041e-05     -6.75e-14
polygon 34 (hole)        3 -3.90173e-05     -5.83e-14
polygon 35 (hole)        3 -9.59845e-05     -1.43e-13
polygon 36 (hole)        8 -4.28707e-01     -6.40e-10
polygon 37 (hole)        4 -2.18619e-04     -3.27e-13
polygon 38 (hole)        6 -8.37554e-01     -1.25e-09
polygon 39 (hole)        5 -2.92235e-04     -4.36e-13
polygon 40           14053  6.67892e+08      9.98e-01
polygon 41 (hole)        3 -7.43616e-06     -1.11e-14
enclosing rectangle: [2667.54, 55941.94] x [21448.47, 50256.33] units
                     (53270 x 28810 units)
Window area = 669517000 square units
Fraction of frame area: 0.436</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(it_month_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="compute-spatio-temporal-kde-1" class="level4">
<h4 class="anchored" data-anchor-id="compute-spatio-temporal-kde-1">Compute Spatio-temporal KDE</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>it_kde <span class="ot">&lt;-</span> <span class="fu">spattemp.density</span>(it_month_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating trivariate smooth...Done.
Edge-correcting...Done.
Conditioning on time...Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(it_kde)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatiotemporal Kernel Density Estimate

Bandwidths
  h = 1223.828 (spatial)
  lambda = 0.0308 (temporal)

No. of observations
  950 

Spatial bound
  Type: polygonal
  2D enclosure: [2667.538, 55941.94] x [21448.47, 50256.33]

Temporal bound
  [1, 7]

Evaluation
  128 x 128 x 7 trivariate lattice
  Density range: [4.097111e-63, 1.992955e-07]</code></pre>
</div>
</div>
</section>
<section id="plotting-spatio-temporal-kde-object-1" class="level4">
<h4 class="anchored" data-anchor-id="plotting-spatio-temporal-kde-object-1">Plotting spatio-temporal KDE object</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>tims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> tims){ </span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(it_kde, i, </span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">override.par=</span><span class="cn">FALSE</span>, </span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fix.range=</span><span class="cn">TRUE</span>, </span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"KDE at month"</span>,i))</span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="stpp-method-1" class="level4">
<h4 class="anchored" data-anchor-id="stpp-method-1">stpp Method</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>it_coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(IT_biz_62021_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>it_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> it_coords[, <span class="dv">1</span>],  </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> it_coords[, <span class="dv">2</span>],</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> IT_biz_62021_sf<span class="sc">$</span><span class="st">`</span><span class="at">date</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>it_stpp <span class="ot">&lt;-</span> <span class="fu">as.3dpoints</span>(it_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(it_stpp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="computing-spatio-temporal-k-function-1" class="level4">
<h4 class="anchored" data-anchor-id="computing-spatio-temporal-k-function-1">Computing spatio-temporal k-function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>it_stik <span class="ot">&lt;-</span> <span class="fu">STIKhat</span>(it_stpp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Space-time data contains duplicated points</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotK</span>(it_stik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The spatio-temporal analysis reveals that over time, IT consultancy business registrations show a gradual accumulation, with no dramatic surges. New registrations tend to follow earlier hotspots rather than creating many new clusters. Temporal slices show increases but not large, abrupt jumps. Growth is more steady. Cumulative counts reflect this smoother growth.</p>
</section>
</section>
</section>
<section id="clothing-retail-business" class="level2">
<h2 class="anchored" data-anchor-id="clothing-retail-business">3. Clothing Retail Business</h2>
<section id="tidying-data-2" class="level3">
<h3 class="anchored" data-anchor-id="tidying-data-2">Tidying Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>ret_biz_47711 <span class="ot">&lt;-</span> acra_data <span class="sc">%&gt;%</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>) <span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(primary_ssic_code <span class="sc">==</span> <span class="dv">47711</span>) <span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date =</span> registration_incorporation_date) <span class="sc">%&gt;%</span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date),</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">YEAR =</span> <span class="fu">year</span>(date),</span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">MONTH_NUM =</span> <span class="fu">month</span>(date),</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">MONTH_ABBR =</span> <span class="fu">month</span>(date,</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">label =</span> <span class="cn">TRUE</span>,</span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>                            <span class="at">abbr =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">postal_code =</span> <span class="fu">str_pad</span>(postal_code,</span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">width =</span> <span class="dv">6</span>, <span class="at">side =</span> <span class="st">"left"</span>, <span class="at">pad =</span> <span class="st">"0"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(YEAR <span class="sc">==</span> <span class="dv">2025</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="geocoding-2" class="level3">
<h3 class="anchored" data-anchor-id="geocoding-2">Geocoding</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>postcodes <span class="ot">&lt;-</span> <span class="fu">unique</span>(ret_biz_47711<span class="sc">$</span>postal_code)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>found <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>not_found <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">postcode =</span> <span class="fu">character</span>())</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://onemap.gov.sg/api/common/elastic/search"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (pc <span class="cf">in</span> postcodes) {</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">searchVal =</span> pc,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">returnGeom =</span> <span class="st">"Y"</span>,</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">getAddrDetails =</span> <span class="st">"Y"</span>,</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">pageNum =</span> <span class="st">"1"</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(url, <span class="at">query =</span> query)</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>  json <span class="ot">&lt;-</span> <span class="fu">content</span>(res)</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (json<span class="sc">$</span>found <span class="sc">!=</span> <span class="dv">0</span>) {</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>    df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(json<span class="sc">$</span>results, <span class="at">stringAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>    df<span class="sc">$</span>input_postcode <span class="ot">&lt;-</span> pc</span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>    found <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(found, df)</span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>    not_found <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(not_found, <span class="fu">data.frame</span>(<span class="at">postcode =</span> pc))</span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>ret_biz_47711 <span class="ot">=</span> ret_biz_47711 <span class="sc">%&gt;%</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(found,</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'postal_code'</span> <span class="ot">=</span> <span class="st">'POSTAL'</span>),</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">relationship =</span> <span class="st">"many-to-many"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>ret_biz_47711_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(ret_biz_47711,</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"X"</span>,<span class="st">"Y"</span>),</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Save ff_biz_56121_sf file</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">#write_rds(ff_biz_56121_sf, "data/rds/ret_biz_47711_sf.rds")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="understanding-data-2" class="level3">
<h3 class="anchored" data-anchor-id="understanding-data-2">Understanding Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>ret_biz_47711_sf <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/ret_biz_47711_sf.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ret_biz_47711_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 6 features and 105 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 17412.09 ymin: 30188.94 xmax: 29207.41 ymax: 46477.9
Projected CRS: SVY21 / Singapore TM
# A tibble: 6 × 106
  uen        issuance_agency_id entity_name               entity_type_descript…¹
  &lt;chr&gt;      &lt;chr&gt;              &lt;chr&gt;                     &lt;chr&gt;                 
1 202501382K ACRA               ASIAN EXPORTS (S) PTE. L… Local Company         
2 202513916D ACRA               BINGZ MOBURGER PTE. LTD.  Local Company         
3 202515176R ACRA               BINGZ LEGEND PTE. LTD.    Local Company         
4 202520978K ACRA               BLACK RHINO PTE. LTD.     Local Company         
5 202505116C ACRA               CELINY PTE. LTD.          Local Company         
6 202517176H ACRA               CHICKIES PTE. LTD.        Local Company         
# ℹ abbreviated name: ¹​entity_type_description
# ℹ 102 more variables: business_constitution_description &lt;chr&gt;,
#   company_type_description &lt;chr&gt;, paf_constitution_description &lt;chr&gt;,
#   entity_status_description &lt;chr&gt;, date &lt;date&gt;, uen_issue_date &lt;date&gt;,
#   address_type &lt;chr&gt;, block &lt;chr&gt;, street_name &lt;chr&gt;, level_no &lt;chr&gt;,
#   unit_no &lt;chr&gt;, building_name &lt;chr&gt;, postal_code &lt;chr&gt;,
#   other_address_line1 &lt;chr&gt;, other_address_line2 &lt;chr&gt;, …</code></pre>
</div>
</div>
<p>Number of businesses</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># number of businesses</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(ret_biz_47711_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 31</code></pre>
</div>
</div>
<p>Plotting data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ret_biz_47711_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: plotting the first 9 out of 105 attributes; use max.plot = 105 to plot
all</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="convert-sf-dataframe-to-ppp-class-2" class="level3">
<h3 class="anchored" data-anchor-id="convert-sf-dataframe-to-ppp-class-2">Convert sf dataframe to ppp class</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>ret_biz_47711_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(ret_biz_47711_sf)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(ret_biz_47711_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ppp"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ret_biz_47711_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern object</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  31 points
Average intensity 7.044323e-08 points per square unit

Coordinates are given to 10 decimal places

Mark variables: uen, issuance_agency_id, entity_name, entity_type_description, 
business_constitution_description, company_type_description, 
paf_constitution_description, entity_status_description, date, uen_issue_date, 
address_type, block, street_name, level_no, unit_no, building_name, 
postal_code, other_address_line1, other_address_line2, account_due_date, 
annual_return_date, primary_ssic_code, primary_ssic_description, 
primary_user_described_activity, YEAR, MONTH_NUM, MONTH_ABBR, SEARCHVAL, 
BLK_NO, ROAD_NAME, BUILDING, ADDRESS, LATITUDE, LONGITUDE, input_postcode, 
SEARCHVAL.1, BLK_NO.1, ROAD_NAME.1, BUILDING.1, ADDRESS.1, POSTAL.1, X.1, Y.1, 
LATITUDE.1, LONGITUDE.1, SEARCHVAL.2, BLK_NO.2, ROAD_NAME.2, BUILDING.2, 
ADDRESS.2, POSTAL.2, X.2, Y.2, LATITUDE.2, LONGITUDE.2, SEARCHVAL.3, BLK_NO.3, 
ROAD_NAME.3, BUILDING.3, ADDRESS.3, POSTAL.3, X.3, Y.3, LATITUDE.3, 
LONGITUDE.3, SEARCHVAL.4, BLK_NO.4, ROAD_NAME.4, BUILDING.4, ADDRESS.4, 
POSTAL.4, X.4, Y.4, LATITUDE.4, LONGITUDE.4, SEARCHVAL.5, BLK_NO.5, 
ROAD_NAME.5, BUILDING.5, ADDRESS.5, POSTAL.5, X.5, Y.5, LATITUDE.5, 
LONGITUDE.5, SEARCHVAL.6, BLK_NO.6, ROAD_NAME.6, BUILDING.6, ADDRESS.6, 
POSTAL.6, X.6, Y.6, LATITUDE.6, LONGITUDE.6, SEARCHVAL.7, BLK_NO.7, 
ROAD_NAME.7, BUILDING.7, ADDRESS.7, POSTAL.7, X.7, Y.7, LATITUDE.7, LONGITUDE.7
Summary:
     uen            issuance_agency_id entity_name       
 Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character  
                                                         
                                                         
                                                         
                                                         
 entity_type_description business_constitution_description
 Length:31               Length:31                        
 Class :character        Class :character                 
 Mode  :character        Mode  :character                 
                                                          
                                                          
                                                          
                                                          
 company_type_description paf_constitution_description
 Length:31                Length:31                   
 Class :character         Class :character            
 Mode  :character         Mode  :character            
                                                      
                                                      
                                                      
                                                      
 entity_status_description      date            uen_issue_date      
 Length:31                 Min.   :2025-01-07   Min.   :2025-01-07  
 Class :character          1st Qu.:2025-02-22   1st Qu.:2025-02-22  
 Mode  :character          Median :2025-04-08   Median :2025-04-08  
                           Mean   :2025-04-07   Mean   :2025-04-07  
                           3rd Qu.:2025-05-15   3rd Qu.:2025-05-15  
                           Max.   :2025-07-31   Max.   :2025-07-31  
                                                                    
 address_type          block           street_name          level_no        
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
   unit_no          building_name      postal_code        other_address_line1
 Length:31          Length:31          Length:31          Length:31          
 Class :character   Class :character   Class :character   Class :character   
 Mode  :character   Mode  :character   Mode  :character   Mode  :character   
                                                                             
                                                                             
                                                                             
                                                                             
 other_address_line2 account_due_date   annual_return_date primary_ssic_code
 Length:31           Length:31          Length:31          Min.   :56121    
 Class :character    Class :character   Class :character   1st Qu.:56121    
 Mode  :character    Mode  :character   Mode  :character   Median :56121    
                                                           Mean   :56121    
                                                           3rd Qu.:56121    
                                                           Max.   :56121    
                                                                            
 primary_ssic_description primary_user_described_activity      YEAR     
 Length:31                Length:31                       Min.   :2025  
 Class :character         Class :character                1st Qu.:2025  
 Mode  :character         Mode  :character                Median :2025  
                                                          Mean   :2025  
                                                          3rd Qu.:2025  
                                                          Max.   :2025  
                                                                        
   MONTH_NUM       MONTH_ABBR  SEARCHVAL            BLK_NO         
 Min.   :1.000   May    :8    Length:31          Length:31         
 1st Qu.:2.000   Feb    :6    Class :character   Class :character  
 Median :4.000   Jan    :4    Mode  :character   Mode  :character  
 Mean   :3.806   Mar    :4                                         
 3rd Qu.:5.000   Jun    :4                                         
 Max.   :7.000   Apr    :3                                         
                 (Other):2                                         
  ROAD_NAME           BUILDING           ADDRESS            LATITUDE        
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  LONGITUDE         input_postcode     SEARCHVAL.1          BLK_NO.1        
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 ROAD_NAME.1         BUILDING.1         ADDRESS.1           POSTAL.1        
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     X.1                Y.1             LATITUDE.1        LONGITUDE.1       
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 SEARCHVAL.2          BLK_NO.2         ROAD_NAME.2         BUILDING.2       
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  ADDRESS.2           POSTAL.2             X.2                Y.2           
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  LATITUDE.2        LONGITUDE.2        SEARCHVAL.3          BLK_NO.3        
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 ROAD_NAME.3         BUILDING.3         ADDRESS.3           POSTAL.3        
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     X.3                Y.3             LATITUDE.3        LONGITUDE.3       
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 SEARCHVAL.4          BLK_NO.4         ROAD_NAME.4         BUILDING.4       
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  ADDRESS.4           POSTAL.4             X.4                Y.4           
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  LATITUDE.4        LONGITUDE.4        SEARCHVAL.5          BLK_NO.5        
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 ROAD_NAME.5         BUILDING.5         ADDRESS.5           POSTAL.5        
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     X.5                Y.5             LATITUDE.5        LONGITUDE.5       
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 SEARCHVAL.6          BLK_NO.6         ROAD_NAME.6         BUILDING.6       
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  ADDRESS.6           POSTAL.6             X.6                Y.6           
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
  LATITUDE.6        LONGITUDE.6        SEARCHVAL.7          BLK_NO.7        
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 ROAD_NAME.7         BUILDING.7         ADDRESS.7           POSTAL.7        
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
     X.7                Y.7             LATITUDE.7        LONGITUDE.7       
 Length:31          Length:31          Length:31          Length:31         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            

Window: rectangle = [17412.09, 40604.5] x [28689.89, 47664.66] units
                    (23190 x 18970 units)
Window area = 440071000 square units</code></pre>
</div>
</div>
</section>
<section id="create-owin-object-2" class="level3">
<h3 class="anchored" data-anchor-id="create-owin-object-2">Create owin object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>mpsz_cl <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/rds/mpsz_cl.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>sg_owin <span class="ot">&lt;-</span> <span class="fu">as.owin</span>(mpsz_cl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sg_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="combine-point-events-object-and-owin-object-2" class="level3">
<h3 class="anchored" data-anchor-id="combine-point-events-object-and-owin-object-2">Combine point events object and owin object</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>ret_biz_47711_ppp <span class="ot">=</span> ret_biz_47711_ppp[sg_owin]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>ret_biz_47711_ppp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern x</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern: 31 points
Mark variables: 
   uen issuance_agency_id entity_name entity_type_description 
business_constitution_description company_type_description 
paf_constitution_description entity_status_description date uen_issue_date 
address_type block street_name level_no unit_no building_name postal_code 
other_address_line1 other_address_line2 account_due_date annual_return_date 
primary_ssic_code primary_ssic_description primary_user_described_activity YEAR 
MONTH_NUM MONTH_ABBR SEARCHVAL BLK_NO ROAD_NAME BUILDING ADDRESS LATITUDE 
LONGITUDE input_postcode SEARCHVAL.1 BLK_NO.1 ROAD_NAME.1 BUILDING.1 ADDRESS.1 
POSTAL.1 X.1 Y.1 LATITUDE.1 LONGITUDE.1 SEARCHVAL.2 BLK_NO.2 ROAD_NAME.2 
BUILDING.2 ADDRESS.2 POSTAL.2 X.2 Y.2 LATITUDE.2 LONGITUDE.2 SEARCHVAL.3 
BLK_NO.3 ROAD_NAME.3 BUILDING.3 ADDRESS.3 POSTAL.3 X.3 Y.3 LATITUDE.3 
LONGITUDE.3 SEARCHVAL.4 BLK_NO.4 ROAD_NAME.4 BUILDING.4 ADDRESS.4 POSTAL.4 X.4 
Y.4 LATITUDE.4 LONGITUDE.4 SEARCHVAL.5 BLK_NO.5 ROAD_NAME.5 BUILDING.5 
ADDRESS.5 POSTAL.5 X.5 Y.5 LATITUDE.5 LONGITUDE.5 SEARCHVAL.6 BLK_NO.6 
ROAD_NAME.6 BUILDING.6 ADDRESS.6 POSTAL.6 X.6 Y.6 LATITUDE.6 LONGITUDE.6 
SEARCHVAL.7 BLK_NO.7 ROAD_NAME.7 BUILDING.7 ADDRESS.7 POSTAL.7 X.7 Y.7 
LATITUDE.7 LONGITUDE.7
window: polygonal boundary
enclosing rectangle: [2667.54, 55941.94] x [21448.47, 50256.33] units</code></pre>
</div>
</div>
</section>
<section id="clark-evan-test-for-nearest-neighbour-analysis-2" class="level3">
<h3 class="anchored" data-anchor-id="clark-evan-test-for-nearest-neighbour-analysis-2">Clark-Evan Test for Nearest Neighbour Analysis</h3>
<p>Without CSR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(ret_biz_47711_ppp,</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clark-Evans test
    No edge correction
    Z-test

data:  ret_biz_47711_ppp
R = 0.55043, p-value = 8.397e-07
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
<p>With CSR</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clarkevans.test</span>(ret_biz_47711_ppp,</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">correction=</span><span class="st">"none"</span>,</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">clipregion=</span><span class="st">"sg_owin"</span>,</span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">alternative=</span><span class="fu">c</span>(<span class="st">"clustered"</span>),</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">method=</span><span class="st">"MonteCarlo"</span>,</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">nsim=</span><span class="dv">99</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Clark-Evans test
    No edge correction
    Monte Carlo test based on 99 simulations of CSR with fixed n

data:  ret_biz_47711_ppp
R = 0.55043, p-value = 0.01
alternative hypothesis: clustered (R &lt; 1)</code></pre>
</div>
</div>
<p>Taking a 95% confidence level, the Clark-Evans test showed that p-value were consistently below the threshold &lt; 0.05, indicating that restaurants are not randomly distributed.</p>
</section>
<section id="kernel-density-estimation-2" class="level3">
<h3 class="anchored" data-anchor-id="kernel-density-estimation-2">Kernel Density Estimation</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>ret_biz_47711_ppp_km <span class="ot">&lt;-</span> <span class="fu">rescale.ppp</span>(</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>  ret_biz_47711_ppp, <span class="dv">1000</span>, <span class="st">"km"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>ret_kde_SG_diggle <span class="ot">&lt;-</span> <span class="fu">density</span>(</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  ret_biz_47711_ppp_km,</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma=</span>bw.diggle,</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">edge=</span><span class="cn">TRUE</span>,</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel=</span><span class="st">"gaussian"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ret_kde_SG_diggle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ret_kde_SG_diggle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>real-valued pixel image
128 x 128 pixel array (ny, nx)
enclosing rectangle: [2.667538, 55.94194] x [21.44847, 50.25633] km
dimensions of each pixel: 0.416 x 0.2250614 km
Image is defined on a subset of the rectangular grid
Subset area = 669.941961122495 square km
Subset area fraction = 0.437
Pixel values (inside window):
    range = [-1.556182e-16, 1.557279]
    integral = 31.21534
    mean = 0.04659409</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>bw <span class="ot">&lt;-</span> <span class="fu">bw.diggle</span>(ret_biz_47711_ppp_km)</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>bw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    sigma 
0.5989893 </code></pre>
</div>
</div>
<p>The spatial KDE for clothing retail shows a pattern distinct from IT consultancy. Sharper clusters around retail hubs, shopping centres, and regional town centres. High density in areas such as major malls and high-street shopping districts; moderate density along busy arterial roads. Lower density in purely residential or industrial zones.</p>
</section>
<section id="nd-order-spatial-point-pattern-analysis-2" class="level3">
<h3 class="anchored" data-anchor-id="nd-order-spatial-point-pattern-analysis-2">2nd Order Spatial Point Pattern Analysis</h3>
<section id="using-k-function-2" class="level4">
<h4 class="anchored" data-anchor-id="using-k-function-2">Using K-Function</h4>
<p>Computing K-Function estimate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>K_ret <span class="ot">=</span> <span class="fu">Kest</span>(ret_biz_47711_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_ret, . <span class="sc">-</span>r <span class="sc">~</span> r, <span class="at">ylab=</span> <span class="st">"K(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-123-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Performing Complete Spatial Randomness Test</strong></p>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<p>Ho = The distribution of clothing retailers in SIngapore are randomly distributed.</p>
<p>H1= The distribution of clothing retailers in SIngapore are not randomly distributed.</p>
<p>The null hypothesis will be rejected if p-value is smaller than alpha value of 0.001.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>K_ret.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(ret_biz_47711_ppp, Kest, <span class="at">nsim =</span> <span class="dv">99</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">glocal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern Y</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern object</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,
61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 
99.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(K_ret.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"K(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-125-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="using-l-function-2" class="level4">
<h4 class="anchored" data-anchor-id="using-l-function-2">Using L-Function</h4>
<p>Computing L Function estimate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>L_ret <span class="ot">=</span> <span class="fu">Lest</span>(ret_biz_47711_ppp, <span class="at">correction =</span> <span class="st">"Ripley"</span>)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_ret, . <span class="sc">-</span>r <span class="sc">~</span> r, </span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span> <span class="st">"L(d)-r"</span>, <span class="at">xlab =</span> <span class="st">"d(m)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Performing Complete Spatial Randomness Test</strong></p>
<p>To confirm the observed spatial patterns above, a hypothesis test will be conducted. The hypothesis and test are as follows:</p>
<p>Ho = The distribution of clothing retailers in SIngapore are randomly distributed.</p>
<p>H1= The distribution of clothing retailers in SIngapore are not randomly distributed.</p>
<p>The null hypothesis will be rejected if p-value if smaller than alpha value of 0.001.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>L_ret.csr <span class="ot">&lt;-</span> <span class="fu">envelope</span>(ret_biz_47711_ppp, Lest, <span class="at">nsim =</span> <span class="dv">99</span>, <span class="at">rank =</span> <span class="dv">1</span>, <span class="at">glocal=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern Y</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: some mark values are NA in the point pattern object</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Generating 99 simulations of CSR  ...
1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,
61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,
81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 
99.

Done.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(L_ret.csr, . <span class="sc">-</span> r <span class="sc">~</span> r, <span class="at">xlab=</span><span class="st">"d"</span>, <span class="at">ylab=</span><span class="st">"L(d)-r"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The second‐order analysis indicates stronger clustering at short distances (likely under 500-700 m). The L(d)−d curve for clothing retail crosses the CSR envelope more deeply at small spatial scales than IT consultancy, meaning clustering is more pronounced. Beyond moderate distances, the curve tends to return toward CSR, indicating that clustering does not extend far beyond retail precinct boundaries. Pair correlation function likely shows significant peaks at small scale, indicating that stores are often very near each other in retail precincts.</p>
</section>
</section>
<section id="spatio-temporal-point-patterns-analysis-2" class="level3">
<h3 class="anchored" data-anchor-id="spatio-temporal-point-patterns-analysis-2">Spatio-Temporal Point Patterns Analysis</h3>
<p>Overall Plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz_cl)<span class="sc">+</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ret_biz_47711_sf) <span class="sc">+</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-129-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="visualizing-geographic-distribution-of-restaurants-by-month-2" class="level4">
<h4 class="anchored" data-anchor-id="visualizing-geographic-distribution-of-restaurants-by-month-2">Visualizing geographic distribution of restaurants by month</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz_cl)<span class="sc">+</span></span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(ret_biz_47711_sf) <span class="sc">+</span></span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">size=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by=</span><span class="st">"MONTH_ABBR"</span>, </span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">free.coords=</span><span class="cn">FALSE</span>, </span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">drop.units =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="computing-stkde-by-month-2" class="level4">
<h4 class="anchored" data-anchor-id="computing-stkde-by-month-2">Computing STKDE by Month</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>ret_month <span class="ot">&lt;-</span> ret_biz_47711_sf <span class="sc">%&gt;%</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(MONTH_NUM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creating-ppp-2" class="level4">
<h4 class="anchored" data-anchor-id="creating-ppp-2">Creating PPP</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>ret_month_ppp <span class="ot">&lt;-</span> <span class="fu">as.ppp</span>(ret_month)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>ret_month_ppp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern: 31 points
marks are numeric, of storage type  'double'
window: rectangle = [17412.09, 40604.5] x [28689.89, 47664.66] units</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ret_month_ppp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  31 points
Average intensity 7.044323e-08 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 10 decimal places

marks are numeric, of type 'double'
Summary:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   2.000   4.000   3.806   5.000   7.000 

Window: rectangle = [17412.09, 40604.5] x [28689.89, 47664.66] units
                    (23190 x 18970 units)
Window area = 440071000 square units</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">duplicated</span>(ret_month_ppp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="including-owin-object-2" class="level4">
<h4 class="anchored" data-anchor-id="including-owin-object-2">Including Owin object</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>ret_month_owin <span class="ot">&lt;-</span> ret_month_ppp[sg_owin]</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ret_month_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Marked planar point pattern:  31 points
Average intensity 4.630206e-08 points per square unit

*Pattern contains duplicated points*

Coordinates are given to 10 decimal places

marks are numeric, of type 'double'
Summary:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  1.000   2.000   4.000   3.806   5.000   7.000 

Window: polygonal boundary
41 separate polygons (26 holes)
                  vertices         area relative.area
polygon 1              285  1.61128e+06      2.41e-03
polygon 2               27  1.50315e+04      2.25e-05
polygon 3 (hole)        41 -4.01660e+04     -6.00e-05
polygon 4 (hole)       317 -5.11280e+04     -7.64e-05
polygon 5 (hole)         3 -4.14100e-04     -6.19e-13
polygon 6               30  2.80002e+04      4.18e-05
polygon 7 (hole)         4 -2.86396e-01     -4.28e-10
polygon 8 (hole)         3 -1.81439e-04     -2.71e-13
polygon 9 (hole)         3 -5.99531e-04     -8.95e-13
polygon 10 (hole)        3 -3.04560e-04     -4.55e-13
polygon 11 (hole)        3 -4.46108e-04     -6.66e-13
polygon 12 (hole)        5 -2.44408e-04     -3.65e-13
polygon 13 (hole)        5 -3.64686e-02     -5.45e-11
polygon 14              71  8.18750e+03      1.22e-05
polygon 15 (hole)       38 -7.79904e+03     -1.16e-05
polygon 16              91  1.49663e+04      2.24e-05
polygon 17 (hole)      395 -7.38124e+03     -1.10e-05
polygon 18              40  1.38607e+04      2.07e-05
polygon 19 (hole)       11 -8.36705e+01     -1.25e-07
polygon 20 (hole)        3 -2.33435e-03     -3.49e-12
polygon 21              45  2.51218e+03      3.75e-06
polygon 22             139  3.22293e+03      4.81e-06
polygon 23             148  3.10395e+03      4.64e-06
polygon 24 (hole)        4 -1.72650e-04     -2.58e-13
polygon 25              75  1.73526e+04      2.59e-05
polygon 26              83  5.28920e+03      7.90e-06
polygon 27             106  3.04104e+03      4.54e-06
polygon 28              71  5.63061e+03      8.41e-06
polygon 29              10  1.99717e+02      2.98e-07
polygon 30 (hole)        3 -1.37223e-02     -2.05e-11
polygon 31 (hole)        3 -8.68789e-04     -1.30e-12
polygon 32 (hole)        3 -3.39815e-04     -5.08e-13
polygon 33 (hole)        3 -4.52041e-05     -6.75e-14
polygon 34 (hole)        3 -3.90173e-05     -5.83e-14
polygon 35 (hole)        3 -9.59845e-05     -1.43e-13
polygon 36 (hole)        8 -4.28707e-01     -6.40e-10
polygon 37 (hole)        4 -2.18619e-04     -3.27e-13
polygon 38 (hole)        6 -8.37554e-01     -1.25e-09
polygon 39 (hole)        5 -2.92235e-04     -4.36e-13
polygon 40           14053  6.67892e+08      9.98e-01
polygon 41 (hole)        3 -7.43616e-06     -1.11e-14
enclosing rectangle: [2667.54, 55941.94] x [21448.47, 50256.33] units
                     (53270 x 28810 units)
Window area = 669517000 square units
Fraction of frame area: 0.436</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ret_month_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-136-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="compute-spatio-temporal-kde-2" class="level4">
<h4 class="anchored" data-anchor-id="compute-spatio-temporal-kde-2">Compute Spatio-temporal KDE</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>ret_kde <span class="ot">&lt;-</span> <span class="fu">spattemp.density</span>(ret_month_owin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Calculating trivariate smooth...Done.
Edge-correcting...Done.
Conditioning on time...Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ret_kde)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Spatiotemporal Kernel Density Estimate

Bandwidths
  h = 2958.192 (spatial)
  lambda = 0.758 (temporal)

No. of observations
  31 

Spatial bound
  Type: polygonal
  2D enclosure: [2667.538, 55941.94] x [21448.47, 50256.33]

Temporal bound
  [1, 7]

Evaluation
  128 x 128 x 7 trivariate lattice
  Density range: [1.486136e-20, 1.603914e-09]</code></pre>
</div>
</div>
</section>
<section id="plotting-spatio-temporal-kde-object-2" class="level4">
<h4 class="anchored" data-anchor-id="plotting-spatio-temporal-kde-object-2">Plotting spatio-temporal KDE object</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>tims <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> tims){ </span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(ret_kde, i, </span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">override.par=</span><span class="cn">FALSE</span>, </span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fix.range=</span><span class="cn">TRUE</span>, </span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"KDE at month"</span>,i))</span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-138-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="stpp-method-2" class="level4">
<h4 class="anchored" data-anchor-id="stpp-method-2">stpp Method</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>ret_coords <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(ret_biz_47711_sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>ret_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> ret_coords[, <span class="dv">1</span>],  </span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> ret_coords[, <span class="dv">2</span>],</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">t =</span> ret_biz_47711_sf<span class="sc">$</span><span class="st">`</span><span class="at">date</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>ret_stpp <span class="ot">&lt;-</span> <span class="fu">as.3dpoints</span>(ret_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ret_stpp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take_Home_Ex01_files/figure-html/unnamed-chunk-142-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="computing-spatio-temporal-k-function-2" class="level4">
<h4 class="anchored" data-anchor-id="computing-spatio-temporal-k-function-2">Computing spatio-temporal k-function</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a>ret_stik <span class="ot">&lt;-</span> <span class="fu">STIKhat</span>(ret_stpp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Space-time data contains duplicated points</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotK</span>(ret_stik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Clothing retail shows more temporal bursts compared to IT consultancy. Certain quarters or months have visible upticks in registrations, possibly linked to seasonal demand or retail promotions / lease-cycle effects. New clusters tend to emerge near existing retail nodes rather than remote expansion. Cumulative registration counts for clothing retail rise in sharper steps during certain time periods, implying periods of accelerated growth.</p>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>